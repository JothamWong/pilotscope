select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 315    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 122    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_discount_amt) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 929    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 736    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_discount_amt) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 543    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 350    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 157    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_net_profit) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 964    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_sales_price) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 771    and dt.d_moy=11  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  dt.d_year         ,item.i_brand_id brand_id         ,item.i_brand brand        ,sum(ss_ext_discount_amt) sum_agg  from  date_dim dt        ,store_sales       ,item  where dt.d_date_sk = store_sales.ss_sold_date_sk    and store_sales.ss_item_sk = item.i_item_sk    and item.i_manufact_id = 578    and dt.d_moy=12  group by dt.d_year       ,item.i_brand       ,item.i_brand_id  order by dt.d_year          ,sum_agg desc          ,brand_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'S' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'W' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'S' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'W' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'U' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4   from store_sales, customer_demographics, date_dim, item, promotion  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_cdemo_sk = cd_demo_sk and        ss_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '14315','35905','14932','75355','66219','21760',                           '24901','15251','83651','23459','79187',                           '93187','60105','34076','16440','54052',                           '40938','96359','49448','43282','29688',                           '19623','32912','83152','43520','61356',                           '23276','37655','42059','15234','82371',                           '40720','83403','77329','35096','68216',                           '24849','29860','62712','20607','69460',                           '27068','59885','95101','52836','52462',                           '49849','69053','85239','67947','57233',                           '44804','28507','38173','73521','41914',                           '69946','18172','37132','73287','42244',                           '24731','46257','62286','31003','16491',                           '34907','72794','21441','50196','22467',                           '12200','78655','97913','25345','14822',                           '89682','54438','71650','26452','40500',                           '84691','62316','67813','49256','67168',                           '47186','20639','55656','60167','79296',                           '10860','61866','11737','20369','21995',                           '26778','26751','53123','56352','16308',                           '46215','80041','88811','63614','12991',                           '46557','26792','77051','77457','10360',                           '18391','39759','60916','91010','20411',                           '80462','57791','80153','32763','40474',                           '70699','45808','13643','58486','56153',                           '12589','24533','83895','23362','77942',                           '93628','18281','43262','58617','92327',                           '68386','29188','43181','17182','37361',                           '99004','78840','87194','98005','39966',                           '73749','63320','13699','76778','71736',                           '51243','53927','50873','44602','75448',                           '49558','32847','11556','69446','41709',                           '71771','58014','79852','16983','57937',                           '77620','89031','10452','84942','94637',                           '57244','26204','42925','46668','21388',                           '46245','71780','41434','86833','44369',                           '18373','30789','43400','52493','26684',                           '84950','12747','22372','59552','63574',                           '55714','42788','18630','45558','99060',                           '30821','66174','76791','67157','89599',                           '95154','12777','96634','80943','19368',                           '58145','33141','75769','65321','62881',                           '84167','59593','66942','21161','98939',                           '51328','64303','56380','50104','99941',                           '94006','42802','31271','57904','10987',                           '12557','58333','53087','56969','34009',                           '98891','50989','64688','48896','23779',                           '42803','53659','19648','18666','14778',                           '31371','17802','36559','73288','22266',                           '92126','71336','54637','11649','45455',                           '24360','17951','10713','12203','17859',                           '49064','61495','83223','54167','60155',                           '54876','60474','98166','83866','77251',                           '32332','14665','51629','55358','22576',                           '28683','98907','91555','37825','68779',                           '60012','15480','99280','10765','14980',                           '53036','10276','90595','24603','42162',                           '96886','84751','64090','39653','90971',                           '64807','77707','74445','67601','42884',                           '20323','35961','83821','79360','86253',                           '56780','99665','63925','44658','54965',                           '60355','61035','48696','67492','42742',                           '67413','62583','10413','37862','66009',                           '99263','16171','14854','23229','12645',                           '20943','27085','77787','22830','16575',                           '13510','26922','69123','33618','89405',                           '37548','89575','62239','49208','69428',                           '19154','68392','59359','48106','10965',                           '26577','65767','13815','58684','10101',                           '33837','18130','69719','77653','61378',                           '57280','72607','26254','39383','37114',                           '46536','31303','19774','90240','15700',                           '98758','31286','10079','89794','20351',                           '66438','30033','59116','23217','10957',                           '55363','55013','31232','28765','53155',                           '93789','95207','24598','60018','90900',                           '24217','51102','70669','50372','33563',                           '68872','66432','43558','33759','20254',                           '21145','43839','39002','78843','93372',                           '42127','20302','84632','87580')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 2002   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '57663','23237','36701','65366','92853','30783',                           '69544','71560','60355','83916','17904',                           '17698','42682','32872','74427','19763',                           '48039','68088','46110','65056','15631',                           '61118','33905','90707','97392','16281',                           '56375','10682','76165','95787','97821',                           '28334','57244','69914','88906','34404',                           '51259','22047','28166','28690','31427',                           '73454','23602','80790','15051','65878',                           '91430','11848','33579','20154','41062',                           '57033','23397','37404','59185','91472',                           '94111','40698','32420','64309','31818',                           '74605','97257','82340','11957','26973',                           '82163','84562','75964','82571','16472',                           '50714','47812','10966','50035','11999',                           '43378','58974','64028','10571','53851',                           '34293','46369','35481','92861','52905',                           '22582','32087','29854','57397','17837',                           '92613','16273','91304','43024','17800',                           '72969','48897','46209','21199','34815',                           '59336','92951','27403','22718','18187',                           '80120','88839','63125','17805','70411',                           '20975','35857','43690','50998','54924',                           '90275','24462','29372','85026','43958',                           '31408','33645','69905','41392','53296',                           '68332','69063','77973','25594','47171',                           '58247','18041','99467','36422','20225',                           '54177','40632','42724','38279','18589',                           '56675','22259','99659','36727','95197',                           '51345','88412','22796','89269','83015',                           '20689','83711','84918','14086','58257',                           '38357','31932','68494','21546','49495',                           '56783','88217','36854','80888','61159',                           '43840','66875','55910','70998','80868',                           '93706','57567','61663','72404','52832',                           '10074','96053','18885','91780','59364',                           '42782','63658','32263','48093','27873',                           '43037','83985','30228','58325','74802',                           '29107','28730','16601','76557','66453',                           '85894','22079','83572','54221','64843',                           '38802','77921','66234','94988','98422',                           '17930','77780','12146','14391','10457',                           '68112','58678','51106','70604','28466',                           '16012','86450','89137','10729','64227',                           '65467','55902','22768','88771','29850',                           '42402','55804','77656','25653','45732',                           '64839','88302','61055','31144','39921',                           '71710','21431','23176','81917','90342',                           '11751','62253','24826','13559','24540',                           '23729','15420','18349','80333','47933',                           '36715','15112','79814','55602','73931',                           '10144','72719','22540','91801','87675',                           '47831','17822','79655','72222','39510',                           '14278','35678','74736','79894','96038',                           '78161','25138','19872','92156','61761',                           '92985','21753','34830','53622','54236',                           '71790','22886','43829','96738','68842',                           '18462','34441','33168','92308','45918',                           '34179','41086','54018','99399','95098',                           '79386','31112','34479','17168','88672',                           '33337','29465','90644','42499','83266',                           '58158','92652','28065','77731','49966',                           '29762','15514','87953','35581','18815',                           '13610','17882','57305','12307','33657',                           '32611','81080','64088','65750','15549',                           '66496','39472','27903','34633','45846',                           '81902','68452','89307','58071','21368',                           '84703','23705','19557','89633','30197',                           '31581','65722','44714','41586','16250',                           '97112','17254','24328','28863','31349',                           '23747','60290','75624','42122','39494',                           '60875','17777','83503','14933','85995',                           '85129','17344','24825','50727','72784',                           '99473','51655','55064','86568','87824',                           '60064','13697','54301','20941','83694',                           '97323','84323','17218','17778','26315',                           '96329','59681','68862','98244','62886',                           '57444','41734','24293','30912','19140',                           '62403','33283','83629','59031','61912',                           '43396','79295','32817','72586')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 1999   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '47929','59160','83127','49024','38136','32564',                           '91826','66023','31299','57978','29528',                           '62223','82045','37262','75252','91600',                           '70366','11686','43708','15705','77260',                           '70640','49270','72793','43305','48764',                           '53999','95732','72044','23264','23271',                           '15961','15346','11459','74852','69835',                           '44762','87031','45178','92446','83394',                           '77895','57260','48255','18051','47180',                           '43332','67368','78061','68213','46604',                           '35562','34127','13236','84534','71878',                           '92431','71203','88303','56498','41951',                           '21793','58105','76407','70481','86716',                           '33140','43974','44254','57504','71349',                           '61792','20121','92473','60737','75601',                           '18794','78108','89812','70169','53006',                           '17692','71394','59042','48935','69226',                           '39471','78492','83163','11469','40025',                           '15405','17388','88603','39742','45576',                           '36931','31467','14692','10156','83773',                           '54233','16822','27793','48487','93563',                           '90968','24025','46547','40366','22904',                           '36640','48139','16660','94633','92710',                           '18417','99461','11208','26537','54218',                           '57813','65777','12773','67787','47168',                           '47187','13188','30292','40016','40394',                           '33612','74436','59319','85840','81319',                           '43565','60694','49318','11040','67947',                           '75444','55621','63224','26501','51086',                           '89494','47480','78019','36275','24033',                           '83140','98470','32504','51380','31800',                           '40589','78692','22713','47892','25618',                           '49922','28673','87744','14614','14032',                           '14511','44719','46375','82363','16094',                           '59526','12311','71261','40248','82422',                           '34796','85479','11386','13080','30950',                           '79160','38265','95945','32260','81132',                           '24640','34430','69971','38560','28274',                           '75029','50327','38277','51826','74725',                           '36882','88090','52502','89449','46440',                           '46327','64462','64447','55804','89351',                           '74048','50781','15050','46003','68340',                           '45012','31686','79661','11918','36859',                           '26656','84978','58882','61354','95657',                           '35967','34947','46823','38012','91307',                           '95254','17473','84885','53633','23604',                           '68814','65545','46420','61438','70717',                           '18467','44906','83369','14686','28844',                           '35206','67865','25269','75214','57622',                           '21531','15626','40842','74457','32073',                           '34353','56068','54620','62249','61194',                           '70340','50735','42638','69815','17025',                           '30959','53576','91070','66504','60173',                           '63215','67694','91473','43009','19916',                           '28749','80921','78453','73230','52152',                           '69633','95810','46217','34602','91573',                           '73202','22053','88895','39242','45294',                           '95536','51657','12188','18858','27353',                           '35393','17519','14225','68961','17367',                           '97850','32787','75137','18057','22929',                           '61980','89878','75419','17354','30947',                           '77779','22472','38324','91629','99480',                           '31543','52157','20472','13862','23434',                           '56763','19593','34236','55357','17365',                           '48770','22892','13173','85823','74311',                           '16650','52022','68645','72685','99991',                           '43280','47329','69820','21397','26096',                           '98654','62665','17098','35667','88278',                           '68631','26467','97087','67575','71347',                           '33509','18546','53290','63720','27520',                           '23733','81865','70234','76823','85977',                           '23550','45379','86729','21156','38911',                           '50962','41580','38933','95345','52104',                           '67220','73277','57843','41208','90504',                           '61407','85445','60409','37553','43506',                           '15994','78231','14268','70327','75512',                           '68953','93372','10238','98802','70881',                           '25924','31937','10012','65371','18026',                           '27103','54198','28988','34976','95846',                           '97132','62456','64649','36547')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 1999   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '64736','63735','39553','96872','67066','37482',                           '65207','13254','62101','32040','10321',                           '40388','74372','86371','10401','29779',                           '26358','11994','52321','90061','44995',                           '58888','96979','48661','72865','47317',                           '11836','77537','30727','43945','38721',                           '12289','31234','47919','82486','30036',                           '65550','17614','71113','34823','45361',                           '41914','92741','52168','87930','57697',                           '63586','11786','15192','15681','21816',                           '80101','13651','92005','30202','94623',                           '17024','43516','84664','22934','37993',                           '20287','50708','52077','47710','63569',                           '74117','98054','32888','32437','36317',                           '68869','41280','74901','23405','54378',                           '84210','68046','12694','35882','87040',                           '31135','11015','57668','31185','71661',                           '69908','29582','73068','47065','62213',                           '27544','36734','49320','92847','36943',                           '40892','89506','83875','73300','55333',                           '68796','37046','54615','81034','20543',                           '96780','12845','36639','60277','88799',                           '18863','15708','42048','54621','96012',                           '52002','27357','94852','15850','64478',                           '60792','27371','44020','79740','39457',                           '59460','74476','60774','73013','84740',                           '15330','23906','90325','14656','50140',                           '68332','90056','67547','48670','33854',                           '25051','24812','25044','12434','10554',                           '54805','25240','75354','79634','45702',                           '52329','27565','65556','78763','45470',                           '32935','15446','10344','11282','46748',                           '20078','64486','44264','90704','67205',                           '99492','36787','58306','53758','41320',                           '26633','30293','27922','10014','41246',                           '22929','52754','86362','22113','68533',                           '34906','98714','23013','82597','56047',                           '51083','46461','52957','85159','26167',                           '31949','20632','47654','56823','77431',                           '73358','70454','41776','58140','28037',                           '83200','53852','86881','58017','20222',                           '63046','26528','50394','99865','74246',                           '21912','30717','35501','79342','54693',                           '73493','54708','69087','28332','67809',                           '23360','45629','99599','80658','19518',                           '77582','30819','45441','16390','27217',                           '30887','69094','90385','41302','90040',                           '25569','28399','50326','63813','80877',                           '65014','51073','41950','30343','67477',                           '40559','42603','50444','68873','83621',                           '61130','99434','37064','18005','12325',                           '16903','21578','39373','62756','29118',                           '14087','98123','13026','60786','17336',                           '35280','27067','14075','66346','41287',                           '25936','22432','70636','61637','76923',                           '45598','92559','92283','50039','40749',                           '38638','45231','88045','41504','38044',                           '41230','26054','74930','56793','27146',                           '37413','32401','67247','59408','77266',                           '84810','16910','25795','30780','54185',                           '95044','17498','22005','68766','18383',                           '56437','69575','19925','47968','80723',                           '60316','28976','16444','60151','14672',                           '75466','39554','23761','25723','86191',                           '20860','23058','41705','69138','12712',                           '48452','22441','26318','27626','31003',                           '73080','32559','37834','32914','56134',                           '25908','37108','22235','18384','30642',                           '42714','63134','97971','32711','48938',                           '24707','18438','12817','54153','49928',                           '88303','23279','73040','46433','52591',                           '87196','30134','89222','40828','62542',                           '50656','38191','59788','41117','60038',                           '59618','94899','41562','15563','37082',                           '84822','85442','42075','28981','78947',                           '57753','18536','11131','33382','47663',                           '73631','88951','55980','30422','79256',                           '90757','86818','73722','39343','21237',                           '43973','49370','21929','11738','41812',                           '76372','13999','27691','30037')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 2001   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '77117','94901','48596','22693','12349','10952',                           '65704','12950','37255','96102','86436',                           '77320','45217','37016','41911','71087',                           '37726','49884','20324','32104','15651',                           '83331','61041','27882','21039','83084',                           '65672','27495','18268','67989','54171',                           '14631','53256','22467','59803','54691',                           '46531','38035','53287','20977','27731',                           '11945','44998','31504','21941','63061',                           '71602','64476','54949','56081','21369',                           '21473','79874','25554','34492','95942',                           '29862','56312','20069','19161','32068',                           '61306','72954','26390','37619','57593',                           '38804','52303','87469','97370','48298',                           '66107','47681','19114','15459','24787',                           '59626','19239','68299','13960','18902',                           '24939','63028','21458','48582','58561',                           '18807','40010','27700','23408','41858',                           '67285','92592','99197','60619','26835',                           '94439','32285','98313','52797','64875',                           '85842','49487','22123','46732','13129',                           '38585','88598','58344','92774','52208',                           '22374','11445','99733','14609','23006',                           '87485','22061','93345','26262','89306',                           '51280','27438','65175','96632','59084',                           '20535','13528','60945','91622','22354',                           '87048','35988','81729','95423','23244',                           '60013','25800','23013','74924','85163',                           '91777','50703','43562','26847','96211',                           '59195','96802','72689','26640','66330',                           '28042','84406','17228','45462','42109',                           '36979','94918','76876','84019','74217',                           '25230','19433','21034','44288','38923',                           '45206','66912','26885','79784','54593',                           '32594','61656','46299','42692','16618',                           '14085','32474','51584','10332','23912',                           '44737','10471','44243','65411','55659',                           '57479','27699','73478','54644','72356',                           '53717','11165','47349','11212','81118',                           '63508','52818','32449','12824','99634',                           '93330','78487','60008','47123','46421',                           '62815','93417','72370','23505','80152',                           '24137','21341','27302','10723','20560',                           '25165','18085','78201','78957','38340',                           '77424','29934','62375','79778','73604',                           '46798','77342','12350','94148','10997',                           '20420','92086','79550','46622','55292',                           '74381','88182','30108','66577','99051',                           '88469','51233','35161','62178','70979',                           '35785','51971','53693','47983','11465',                           '29629','97213','24022','27607','43527',                           '53525','33523','11719','76495','25890',                           '72310','16485','32026','99873','35923',                           '53248','24474','56000','77239','33267',                           '15964','93472','73537','49554','59326',                           '11073','29716','51372','30138','46742',                           '76026','53785','87195','84930','49205',                           '16549','37572','83870','36868','33168',                           '15323','18708','92730','40090','35400',                           '88058','11253','22989','33359','29388',                           '86336','52630','74448','12225','38848',                           '91693','33140','31523','84002','20590',                           '38991','84531','80630','65004','14340',                           '55138','13169','49072','63208','71868',                           '66748','97633','15012','27716','24541',                           '71787','36714','22349','97433','75365',                           '61455','15331','82816','19599','61120',                           '44178','50585','88758','93561','40096',                           '10444','78293','41058','83786','42394',                           '16588','12144','99713','49787','76557',                           '96795','88680','43676','53139','17604',                           '26127','12719','64086','77006','42460',                           '93166','41440','41580','70536','49115',                           '99067','53003','77049','93372','24819',                           '16358','29533','72368','77750','35979',                           '20811','65316','78949','17759','80204',                           '35958','55320','69110','60707','34487',                           '12949','12343','15490','74053','24823',                           '25236','64557','33438','47688','22122',                           '85152','78944','44666','12611')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2001   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '98350','70586','36052','37362','80654','62224',                           '88974','81363','98638','70164','49081',                           '17269','23424','76134','36375','10990',                           '47175','45004','86354','73956','60364',                           '92853','25103','54747','38085','81145',                           '34598','59202','41152','11682','98486',                           '41976','87955','93335','53205','43966',                           '49073','51198','58134','11615','47348',                           '25520','29339','30366','44544','58728',                           '89797','76370','24996','72438','41966',                           '87375','36582','64776','23979','97432',                           '67507','45556','89885','87656','38520',                           '95972','61495','64571','31496','23628',                           '64109','14367','52050','72303','78596',                           '82468','31003','64379','21633','37104',                           '42239','25945','87627','79731','38453',                           '72648','79156','79377','73910','87369',                           '57224','23839','64520','77850','25592',                           '53458','53310','89437','10004','24868',                           '58145','57830','67195','41429','65814',                           '51630','64788','90241','14834','38840',                           '38259','45539','37580','98153','40170',                           '52453','97543','91083','58244','34024',                           '26085','84114','47718','36674','34290',                           '44837','54334','36389','83731','52695',                           '90392','57599','28350','72584','19920',                           '95249','54423','41581','27086','99321',                           '33755','80833','96684','11178','29370',                           '14924','23886','72395','79978','30710',                           '89240','13834','70024','69999','84302',                           '75341','37524','73923','95581','14513',                           '21277','15786','20659','29317','99485',                           '84793','52465','60641','17221','92947',                           '18672','83518','14816','17184','98125',                           '74341','52999','25320','47237','93898',                           '62382','66273','49961','74094','16540',                           '41595','19639','86038','17787','14936',                           '76113','39792','22540','16532','90652',                           '24987','50238','33617','21912','32208',                           '88148','77558','19245','66064','74878',                           '35652','10694','66193','14734','11627',                           '22159','26254','10166','41584','45602',                           '51371','61867','55005','74664','75406',                           '66480','77815','40671','96189','92028',                           '28210','53796','69823','24358','91749',                           '32475','95834','64354','55683','43781',                           '69889','43663','50231','54594','57465',                           '56669','55863','47889','40684','94943',                           '28277','11136','15276','36849','74481',                           '75587','88060','94618','72363','29309',                           '16315','19769','83919','91660','14377',                           '50491','95167','35489','33375','36309',                           '63990','28447','49254','36735','64935',                           '73545','86813','51684','76052','54573',                           '86829','20798','43277','37471','54404',                           '39408','48379','59736','34725','66721',                           '19356','54414','59715','61491','90781',                           '76979','55913','59470','72788','21518',                           '37994','62237','28213','40302','16480',                           '74375','35465','56736','37308','22717',                           '33707','81024','94814','25919','14101',                           '63151','46498','22835','75068','31319',                           '57000','82122','37331','22402','30938',                           '16212','31079','22122','55745','68345',                           '20073','71105','32684','73489','87270',                           '19071','32716','24733','21155','96160',                           '71638','17104','62172','47399','70072',                           '60416','35555','33673','56089','27424',                           '66382','15071','65604','55945','13254',                           '38016','26818','71283','48139','70985',                           '26861','93483','47023','60944','72375',                           '34263','85304','19423','20097','33667',                           '69268','20443','32440','16308','80064',                           '66814','40668','12444','29613','90591',                           '68966','38791','59461','43408','44252',                           '21123','42749','15055','28278','77530',                           '42387','77524','35681','57005','79718',                           '81951','92546','65302','69281','79838',                           '66494','21560','40640','76161','55153',                           '17464','15528','76498','30754')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 1998   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '45978','24417','42074','61493','35595','23496',                           '22972','28594','69454','37873','36025',                           '52198','45312','64167','53352','65448',                           '88733','16733','12970','66568','34389',                           '85150','72812','68257','88855','90845',                           '41870','34735','16090','37978','92494',                           '26155','37132','78836','85621','66720',                           '29933','78257','18652','40436','22451',                           '54817','41295','92882','11829','67002',                           '16629','53752','38063','21683','81055',                           '98528','34826','62190','41068','34252',                           '95351','43732','91970','54771','20218',                           '21779','48767','12595','63775','74542',                           '58403','87531','16631','55165','86664',                           '88699','46818','37681','34773','42945',                           '36977','21550','17765','87552','42482',                           '12742','46551','12231','17938','78712',                           '73228','42602','34332','29658','45130',                           '34016','33335','23557','59456','81026',                           '24861','78167','57418','85002','90583',                           '46527','98606','15724','16775','38187',                           '45485','71375','20543','67198','28110',                           '63108','27876','80789','10698','91955',                           '87101','17223','20255','80237','34369',                           '16669','92153','41386','52197','57373',                           '15858','12021','32344','59899','18616',                           '16978','68984','29758','93975','35640',                           '17186','62243','86708','94963','77960',                           '16108','38456','29054','16961','86853',                           '19552','20866','73712','17005','44229',                           '92972','84850','47792','71562','14564',                           '69802','20418','47516','47967','27475',                           '20959','83083','37789','31255','40577',                           '46388','22342','91325','16551','33351',                           '40105','34382','71706','70041','40397',                           '78932','48617','34937','14441','42843',                           '59344','38581','73513','13387','53700',                           '64104','21846','13080','45837','37203',                           '57703','45973','34710','59748','60006',                           '34222','11193','93924','70910','65437',                           '31277','49354','81292','65032','33127',                           '22083','92980','51383','52831','30168',                           '22592','36909','57706','14515','57860',                           '67623','10221','96429','71442','55716',                           '77973','20040','84280','63294','63769',                           '93809','41518','12185','59114','87844',                           '50369','14807','85568','67450','30631',                           '21798','64289','78360','28468','56976',                           '30217','47867','23360','91772','57364',                           '10141','87313','72897','51047','49961',                           '89862','10569','55211','41911','26318',                           '60712','12718','15113','25875','88081',                           '17593','48037','80265','37279','63165',                           '75359','99882','44095','63433','85685',                           '64567','56853','25195','18553','28417',                           '10905','25685','85286','28272','27368',                           '78850','70893','42547','48406','75725',                           '71727','49847','14920','62200','21990',                           '41934','56739','52950','37102','48965',                           '59604','26781','49780','96642','42200',                           '12941','67457','30613','72090','99157',                           '22433','15217','33696','11877','61687',                           '70847','20132','32249','35580','14506',                           '26845','32790','29295','23831','93164',                           '89575','40252','19831','56335','58418',                           '36014','89516','44837','12898','65144',                           '64052','39874','99049','96897','99980',                           '77878','38505','68588','99701','45586',                           '26219','53737','96503','74620','33801',                           '51298','28525','24350','35473','29620',                           '23376','93187','29826','20274','10814',                           '13668','27764','61207','63999','26134',                           '45370','56155','85802','29797','72728',                           '34561','69765','37839','28851','63207',                           '70028','41095','46287','99066','93966',                           '87853','48567','24879','88850','22791',                           '83600','28164','16274','36883','18991',                           '93284','38674','22768','34402','41420',                           '24105','74916','47009','83680','64288',                           '12712','95407','24683','26471')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 1998   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '96424','40409','38904','70020','66159','74768',                           '52312','62903','74419','23497','17430',                           '10499','30073','20115','62349','24949',                           '19211','78462','24034','65314','94913',                           '15544','36874','81767','55825','34635',                           '45238','17872','10381','63112','53104',                           '69884','23645','80473','16010','64353',                           '76508','48188','63236','55326','79582',                           '77109','33836','14585','98856','94677',                           '51857','85685','45384','52234','32826',                           '48686','63698','73209','95580','16765',                           '34522','36824','97718','87549','14293',                           '97336','47610','44776','20081','55958',                           '46326','54650','27756','57635','34928',                           '88558','91806','20707','93407','47377',                           '75874','23385','31440','84530','80306',                           '86052','91279','10626','67536','39260',                           '47858','38543','96284','27728','67318',                           '82057','31888','39554','22561','35171',                           '81577','23134','62521','68582','17867',                           '10718','36067','23541','11267','84043',                           '33832','14792','38521','19373','16094',                           '33036','83386','12978','68220','62332',                           '61611','59611','67694','63851','15518',                           '45400','62960','71565','19762','68850',                           '91246','78949','67093','84823','75567',                           '14356','78587','63991','80430','21572',                           '14612','15257','50820','13540','42903',                           '17292','17623','33311','15916','16693',                           '80056','21545','71047','16263','36599',                           '35395','13945','33185','33041','66995',                           '22091','61551','26297','10639','30637',                           '10423','83883','39992','68493','54080',                           '22285','30292','31949','85310','58577',                           '85022','72098','50216','50979','68341',                           '21654','53708','19913','50521','83431',                           '47951','19737','45405','79185','47756',                           '17284','34205','14591','99306','21700',                           '83928','48061','96153','76222','42857',                           '12938','95436','10889','24777','11981',                           '45632','61058','67860','58476','74779',                           '73931','38595','33470','68149','85164',                           '13782','13517','42370','60277','68534',                           '48352','15945','41596','38348','35623',                           '10917','49106','40768','16333','37561',                           '25867','43494','11840','97527','78974',                           '27282','65694','24552','75118','32108',                           '55760','14696','88943','79803','57467',                           '75187','77868','60866','28743','57716',                           '53809','19862','19247','29731','31221',                           '72584','30257','45664','68962','17919',                           '47250','65174','21646','36494','40202',                           '53116','43741','20445','31561','31312',                           '28006','82535','85158','23139','28550',                           '19369','30655','67548','96952','25664',                           '16047','99742','43601','30038','40380',                           '23816','86894','26385','28115','16497',                           '23520','11584','76475','19899','56552',                           '97063','92049','85532','27549','16679',                           '90377','28456','85721','29335','50954',                           '38363','12087','58252','66719','14899',                           '82297','17068','34775','52737','36278',                           '86971','32990','43377','55291','27023',                           '77629','73107','49059','91296','47023',                           '44020','59738','62623','66708','67395',                           '82647','32586','68154','67760','92086',                           '70169','19412','81081','65831','45742',                           '67123','83315','13599','51755','21090',                           '52003','57171','77522','30198','42949',                           '30504','27162','31171','99166','96605',                           '79843','68817','12836','70584','79211',                           '77683','13145','41289','17398','67138',                           '21472','14191','98798','51809','38704',                           '98661','91387','63234','63836','58083',                           '13525','25950','25748','56754','28622',                           '67057','52708','54708','50102','72182',                           '57689','36035','22348','14896','11699',                           '18606','72952','23102','33006','39881',                           '65889','31919','23428','23790','89470',                           '21492','81049','94838','56686')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 2000   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '17182','33472','13297','23093','50775','86226',                           '51606','36609','14121','41766','75227',                           '40272','61137','73680','47318','43805',                           '49740','50191','89227','11740','45994',                           '12024','84583','95277','25482','50116',                           '24421','64666','23647','61058','63434',                           '78160','61467','61326','18454','68339',                           '95547','23690','76168','14431','96397',                           '60045','95118','11216','34414','89997',                           '31578','66252','55578','13653','10245',                           '21099','93059','74431','41248','18255',                           '10350','44155','63601','64317','38419',                           '55814','28702','71119','19697','70307',                           '21708','27368','35793','18805','63043',                           '74737','40441','36709','29302','94262',                           '51290','91743','48240','57243','40774',                           '72930','38790','51586','20498','36042',                           '73132','16328','42935','62799','89506',                           '93180','26965','44055','43499','24827',                           '76227','16449','36273','70243','85232',                           '77725','55974','51788','36719','13267',                           '12808','52730','80815','72503','73119',                           '26357','79484','24293','21814','77257',                           '31785','75997','42015','74263','32131',                           '27353','12308','66766','26164','55730',                           '46790','60554','46744','50207','20851',                           '91214','16393','42286','15420','57137',                           '50967','15244','10848','89940','44274',                           '18476','38714','33351','42107','96433',                           '75696','28577','11966','97370','60924',                           '14702','33040','79800','82296','12888',                           '64380','95397','98954','89443','75062',                           '81468','33309','54342','16094','30439',                           '71272','98136','43667','22620','83803',                           '19582','13461','60755','18895','22686',                           '22032','89633','50831','61821','92311',                           '75168','88985','17297','20228','58470',                           '84683','36298','37841','43383','45762',                           '64861','38747','44452','80323','96391',                           '53427','51778','67792','37155','79738',                           '81632','23403','16188','83105','97669',                           '35305','79399','13474','15624','91070',                           '80059','85695','11341','37741','26580',                           '22213','43892','18304','35293','68555',                           '59304','56356','99832','69905','22908',                           '89910','22886','64819','39381','61874',                           '87842','55168','84917','51380','65873',                           '61237','22948','97233','16257','64689',                           '28300','38054','42667','19175','91340',                           '17932','23529','85748','92062','92620',                           '36573','78886','47911','63966','52597',                           '74301','95847','88177','66017','72234',                           '17851','24521','42333','25843','54035',                           '35814','35216','99741','45812','64075',                           '18506','62177','23039','84869','62614',                           '71632','83799','38758','43444','49224',                           '67644','28721','83795','58266','33681',                           '47188','70330','87928','45657','51006',                           '26697','45451','25665','17996','66654',                           '14427','23778','33913','93638','37376',                           '41516','19900','78618','42119','21786',                           '58413','53706','43351','16301','21466',                           '30075','62451','80653','68289','50498',                           '22305','23839','83290','94723','47345',                           '51812','79224','12270','39489','99813',                           '45633','18263','35274','35682','60450',                           '60151','29650','54738','28652','39447',                           '46733','26425','54771','35702','56570',                           '79787','90819','68301','14551','63742',                           '14648','56770','38715','30633','48199',                           '58404','27911','58091','45065','29137',                           '90133','21578','47226','87606','54372',                           '91914','47894','39814','95658','42405',                           '13140','23009','97351','57807','12223',                           '78981','97698','44764','29497','59672',                           '56537','37245','31288','55885','38240',                           '22237','40024','10908','60564','13271',                           '30368','63155','37740','92573','73840',                           '67354','85275','34655','80352','44075',                           '76893','81518','47873','23593')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 1 and d_year = 2000   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select  s_store_name       ,sum(ss_net_profit)  from store_sales      ,date_dim      ,store,      (select ca_zip      from (       SELECT substr(ca_zip,1,5) ca_zip       FROM customer_address       WHERE substr(ca_zip,1,5) IN (                           '96632','33772','35932','71060','86058','93665',                           '99150','51152','83332','50059','43715',                           '95554','73089','82597','88323','56308',                           '91756','21920','21529','90083','53815',                           '28303','48645','25023','98781','10781',                           '57520','78275','18714','11367','41421',                           '62339','37655','30258','51833','89175',                           '77142','82839','89100','43252','37023',                           '27070','86909','43596','26252','54013',                           '68051','35172','72125','60572','85117',                           '29898','49767','13081','27797','14511',                           '76781','24982','74614','88352','92443',                           '53093','26426','43020','68389','12434',                           '30374','62534','68072','49812','30061',                           '73718','79076','41097','57490','17972',                           '26706','96483','59828','45265','80402',                           '13024','64472','74440','36814','85758',                           '94908','23085','17892','41668','17115',                           '20656','24321','79671','25305','99558',                           '21362','48972','60446','50573','65295',                           '37571','56376','70432','34209','38978',                           '58065','37490','38993','29924','38410',                           '22337','69229','86645','56971','69908',                           '43575','30661','16336','84675','42391',                           '25418','71417','25238','51425','20573',                           '98687','60921','68727','99138','74157',                           '18230','79807','61603','61964','46149',                           '72968','34523','97286','42400','30526',                           '79626','53452','28603','47041','87803',                           '71336','29556','65717','96834','55340',                           '25797','21170','17934','45750','98111',                           '79825','77777','86813','85404','11977',                           '45523','43026','41790','70478','91931',                           '69012','12291','99692','27472','18186',                           '18852','18147','44273','31631','50799',                           '70014','90681','27139','55595','51150',                           '55627','20315','79189','83834','17773',                           '58819','27331','43951','86218','74341',                           '62271','17462','62336','35841','65058',                           '33508','41932','42587','58996','84913',                           '63953','23952','65298','20995','54762',                           '20734','25247','16143','78953','96976',                           '56959','50396','78329','62983','55309',                           '44843','45801','27418','62426','32037',                           '57902','36783','62608','22443','24236',                           '35597','52217','91483','35254','10070',                           '64755','71615','82520','65473','72587',                           '54085','74062','85955','42635','90759',                           '53900','14909','65957','85177','94842',                           '39867','42990','18279','41707','18942',                           '31697','69694','49199','52617','86261',                           '44009','75492','64708','44031','35008',                           '80149','26530','87158','55338','68111',                           '66114','82980','28632','64328','49253',                           '43753','89380','89403','84209','46163',                           '34287','33876','64254','14041','62478',                           '86701','12908','82945','82818','72062',                           '14353','47023','90257','25297','54949',                           '13060','31861','28074','98443','53307',                           '68276','28807','77037','52036','55065',                           '19164','94053','43154','17519','93755',                           '56608','83991','30077','15268','68858',                           '90820','58991','43360','54526','24347',                           '73282','37923','17627','93248','96680',                           '14341','51827','61927','65167','88362',                           '21829','68218','21563','91860','45845',                           '35671','90949','38546','44541','91676',                           '25365','67855','96039','11302','83523',                           '54506','20448','47506','77118','11953',                           '64004','77499','71241','33878','54695',                           '21779','94356','76612','11253','31120',                           '45556','69094','21561','64497','62970',                           '63676','69350','28437','56690','39245',                           '46773','44631','20384','59247','26046',                           '26151','58346','29442','12946','24085',                           '93007','91175','25049','56952','50709',                           '36675','43877','39084','59158','71324',                           '24339','53358','16475','37021','62918',                           '99329','61255','39067','42043','88796',                           '26425','58376','77545','21834')      intersect       select ca_zip       from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt             FROM customer_address, customer             WHERE ca_address_sk = c_current_addr_sk and                   c_preferred_cust_flag='Y'             group by ca_zip             having count(*) > 10)A1)A2) V1  where ss_store_sk = s_store_sk   and ss_sold_date_sk = d_date_sk   and d_qoy = 2 and d_year = 2002   and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))  group by s_store_name  order by s_store_name  limit 100;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 35979             then (select avg(ss_ext_list_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 116053             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 383465             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 5356             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 329392             then (select avg(ss_ext_list_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 419210             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 223238             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 236702             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 107845             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 382854             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 83403             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 129571             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 125073             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 9025             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 208137             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 180486             then (select avg(ss_ext_sales_price)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 213736             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 329554             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 29036             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 477067             then (select avg(ss_ext_sales_price)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 86713             then (select avg(ss_ext_discount_amt)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 448985             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 205787             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 12694             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 484             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 178242             then (select avg(ss_ext_discount_amt)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 4009             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 123403             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 34322             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 127633             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 35979             then (select avg(ss_ext_discount_amt)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 475836             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 192479             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 383879             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 61396             then (select avg(ss_ext_discount_amt)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 431353             then (select avg(ss_ext_tax)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 258944             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 102196             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 21             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 219032             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 375162             then (select avg(ss_ext_tax)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 170316             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 285331             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 299662             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 381429             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_paid_inc_tax)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select case when (select count(*)                    from store_sales                    where ss_quantity between 1 and 20) > 70500             then (select avg(ss_ext_tax)                    from store_sales                    where ss_quantity between 1 and 20)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 1 and 20) end bucket1 ,        case when (select count(*)                   from store_sales                   where ss_quantity between 21 and 40) > 424616             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 21 and 40)              else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 21 and 40) end bucket2,        case when (select count(*)                   from store_sales                   where ss_quantity between 41 and 60) > 55404             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 41 and 60)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 41 and 60) end bucket3,        case when (select count(*)                   from store_sales                   where ss_quantity between 61 and 80) > 3690             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 61 and 80)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 61 and 80) end bucket4,        case when (select count(*)                   from store_sales                   where ss_quantity between 81 and 100) > 316059             then (select avg(ss_ext_tax)                   from store_sales                   where ss_quantity between 81 and 100)             else (select avg(ss_net_profit)                   from store_sales                   where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Hickory County','Clear Creek County','Hempstead County','Asotin County','Lake County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 4 and 4+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 ANd 4+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Scott County','Ward County','Clay County','Ballard County','Washington County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 1 and 1+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 1 ANd 1+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 1 and 1+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Letcher County','Juneau County','Jersey County','Williamsburg County','Jackson County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Northampton County','McLean County','Nicollet County','Marengo County','Maries County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 3 and 3+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 3 ANd 3+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 3 and 3+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Hansford County','Grant County','Pike County','Anchorage Borough','Huntingdon County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 4 and 4+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 ANd 4+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Lancaster County','Cheshire County','Alcorn County','Henry County','Clarke County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Cherokee County','Merced County','Jefferson County','Cheboygan County','Lorain County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_moy between 3 and 3+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 3 ANd 3+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_moy between 3 and 3+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Clinton County','Putnam County','Calvert County','Dauphin County','Coryell County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 4 and 4+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 ANd 4+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Madison County','Juneau County','Perry County','Knox County','Cache County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 1 and 1+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 ANd 1+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 1 and 1+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3,   cd_dep_count,   count(*) cnt4,   cd_dep_employed_count,   count(*) cnt5,   cd_dep_college_count,   count(*) cnt6  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_county in ('Goodhue County','Harrison County','Edwards County','Dickens County','Levy County') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_moy between 2 and 2+3) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 2 ANd 2+3) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_moy between 2 and 2+3))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Home', 'Sports', 'Shoes')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2000-02-16' as date)  				and (cast('2000-02-16' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Children', 'Sports', 'Shoes')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2000-05-09' as date)  				and (cast('2000-05-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Books', 'Jewelry', 'Children')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2000-02-01' as date)  				and (cast('2000-02-01' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Jewelry', 'Music', 'Shoes')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1998-04-29' as date)  				and (cast('1998-04-29' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Children', 'Electronics', 'Men')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1998-02-17' as date)  				and (cast('1998-02-17' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Electronics', 'Music', 'Sports')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2001-04-03' as date)  				and (cast('2001-04-03' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Home', 'Men', 'Electronics')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2001-01-23' as date)  				and (cast('2001-01-23' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Shoes', 'Jewelry', 'Men')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2001-03-09' as date)  				and (cast('2001-03-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Shoes', 'Children', 'Books')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1999-06-27' as date)  				and (cast('1999-06-27' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Sports', 'Men', 'Children')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1999-02-11' as date)  				and (cast('1999-02-11' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Unknown'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'College'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MT', 'VA', 'MI')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MN', 'AL', 'SD')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('PA', 'GA', 'OK')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OR', 'KY', 'IL')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TX', 'GA', 'CO')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('IA', 'TN', 'NY')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Secondary'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = '4 yr Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TN', 'WI', 'CA')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('CO', 'VA', 'MO')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('AR', 'MS', 'ND')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Unknown'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('IL', 'FL', 'MI')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('TX', 'LA', 'ID')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('GA', 'AL', 'IA')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'College'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('NY', 'KS', 'NC')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MO', 'IL', 'IN')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MT', 'WV', 'OH')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'College'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Secondary'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MO', 'TX', 'WA')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('WI', 'GA', 'WV')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MI', 'VA', 'ND')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = 'College'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Unknown'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MI', 'IL', 'TX')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('CA', 'IA', 'NE')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OH', 'OK', 'PA')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = 'Secondary'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = '4 yr Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OH', 'PA', 'KS')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('MO', 'ID', 'NC')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('CA', 'KY', 'AL')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'S'   and cd_education_status = 'Secondary'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'M'   and cd_education_status = 'Advanced Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('PA', 'SC', 'VA')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('AK', 'HI', 'TN')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('FL', 'CO', 'ME')   and ss_net_profit between 50 and 250        )) ;
select avg(ss_quantity)        ,avg(ss_ext_sales_price)        ,avg(ss_ext_wholesale_cost)        ,sum(ss_ext_wholesale_cost)  from store_sales      ,store      ,customer_demographics      ,household_demographics      ,customer_address      ,date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and((ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'U'   and cd_education_status = 'College'   and ss_sales_price between 100.00 and 150.00   and hd_dep_count = 3         )or      (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'D'   and cd_education_status = '2 yr Degree'   and ss_sales_price between 50.00 and 100.00      and hd_dep_count = 1      ) or       (ss_hdemo_sk=hd_demo_sk   and cd_demo_sk = ss_cdemo_sk   and cd_marital_status = 'W'   and cd_education_status = '4 yr Degree'   and ss_sales_price between 150.00 and 200.00    and hd_dep_count = 1        ))  and((ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OK', 'OR', 'KS')   and ss_net_profit between 100 and 200        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('NC', 'TX', 'TN')   and ss_net_profit between 150 and 300        ) or      (ss_addr_sk = ca_address_sk   and ca_country = 'United States'   and ca_state in ('OH', 'ME', 'VA')   and ss_net_profit between 50 and 250        )) ;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-2-01' and             (cast('2001-2-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'AR' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Walker County','Ziebach County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-5-01' and             (cast('2001-5-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'WI' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Ziebach County','Walker County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2001-3-01' and             (cast('2001-3-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'NE' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Ziebach County','Williamson County','Walker County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-2-01' and             (cast('2002-2-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'MO' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Walker County','Ziebach County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-5-01' and             (cast('2002-5-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Walker County','Williamson County','Ziebach County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-3-01' and             (cast('2002-3-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'CA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Walker County','Ziebach County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '2002-2-01' and             (cast('2002-2-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'MO' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Walker County','Ziebach County','Williamson County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '1999-4-01' and             (cast('1999-4-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'WA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Walker County','Williamson County','Ziebach County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '1999-3-01' and             (cast('1999-3-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'IN' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Ziebach County','Williamson County','Walker County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select      count(distinct cs_order_number) as ordercount   ,sum(cs_ext_ship_cost) as totalshippingcost   ,sum(cs_net_profit) as totalnetprofit from    catalog_sales cs1   ,date_dim   ,customer_address   ,call_center where     d_date between '1999-5-01' and             (cast('1999-5-01' as date) + interval 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'NJ' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Walker County','Williamson County','Ziebach County','Williamson County',                   'Ziebach County' ) and exists (select *             from catalog_sales cs2             where cs1.cs_order_number = cs2.cs_order_number               and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select *                from catalog_returns cr1                where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Advanced Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (8,4,3,12,2,5) and        d_year = 2000 and        ca_state in ('NE','GA','CA'                    ,'AZ','IL','PA','TX')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Primary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (9,3,8,7,6,12) and        d_year = 2002 and        ca_state in ('NY','CO','WA'                    ,'TX','OH','NE','ND')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'College' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (10,11,12,4,9,8) and        d_year = 1999 and        ca_state in ('FL','WV','KS'                    ,'PA','WY','TN','IA')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = '2 yr Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (5,9,6,1,7,10) and        d_year = 2001 and        ca_state in ('AR','MI','NC'                    ,'MN','ME','IA','OH')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'Advanced Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (12,1,4,9,3,10) and        d_year = 1998 and        ca_state in ('KS','MS','NJ'                    ,'IA','VA','OH','WI')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Primary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (7,9,1,5,4,6) and        d_year = 2000 and        ca_state in ('WA','TN','SD'                    ,'VA','IA','AK','SC')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = 'Secondary' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (2,3,11,7,1,10) and        d_year = 2002 and        ca_state in ('AR','TX','NE'                    ,'CA','MN','GA','IL')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = '2 yr Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (6,12,10,7,9,4) and        d_year = 1999 and        ca_state in ('ND','MO','UT'                    ,'DE','WV','GA','NE')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = '4 yr Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (3,8,9,7,2,12) and        d_year = 1999 and        ca_state in ('TX','UT','IL'                    ,'OK','GA','SD','CA')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = 'Unknown' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (1,8,9,6,3,11) and        d_year = 2001 and        ca_state in ('KY','KS','MI'                    ,'GA','NM','IA','AL')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=28    and d_moy=11    and d_year=2000    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=28    and d_moy=12    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=29    and d_moy=12    and d_year=1999    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=63    and d_moy=12    and d_year=2002    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=64    and d_moy=12    and d_year=1998    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=65    and d_moy=11    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=66    and d_moy=11    and d_year=2002    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=96    and d_moy=11    and d_year=2000    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=81    and d_moy=11    and d_year=2001    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item,customer,customer_address,store  where d_date_sk = ss_sold_date_sk    and ss_item_sk = i_item_sk    and i_manager_id=3    and d_moy=12    and d_year=2000    and ss_customer_sk = c_customer_sk     and c_current_addr_sk = ca_address_sk    and substr(ca_zip,1,5) <> substr(s_zip,1,5)     and ss_store_sk = s_store_sk   group by i_brand       ,i_brand_id       ,i_manufact_id       ,i_manufact  order by ext_price desc          ,i_brand          ,i_brand_id          ,i_manufact_id          ,i_manufact limit 100 ;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Home', 'Sports', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-02-16' as date)   				and (cast('2000-02-16' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Children', 'Sports', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-05-09' as date)   				and (cast('2000-05-09' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Books', 'Jewelry', 'Children')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-02-01' as date)   				and (cast('2000-02-01' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Jewelry', 'Music', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-04-29' as date)   				and (cast('1998-04-29' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Children', 'Electronics', 'Men')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-02-17' as date)   				and (cast('1998-02-17' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Electronics', 'Music', 'Sports')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2001-04-03' as date)   				and (cast('2001-04-03' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Home', 'Men', 'Electronics')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2001-01-23' as date)   				and (cast('2001-01-23' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Jewelry', 'Men')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2001-03-09' as date)   				and (cast('2001-03-09' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Children', 'Books')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-06-27' as date)   				and (cast('1999-06-27' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Sports', 'Men', 'Children')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-02-11' as date)   				and (cast('1999-02-11' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-02' as date) - interval 30 days)                     and (cast ('2001-05-02' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-21' as date) - interval 30 days)                     and (cast ('2000-06-21' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-07' as date) - interval 30 days)                     and (cast ('1999-03-07' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-14' as date) - interval 30 days)                     and (cast ('1998-06-14' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-11' as date) - interval 30 days)                     and (cast ('2000-06-11' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-03' as date) - interval 30 days)                     and (cast ('2002-03-03' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-06' as date) - interval 30 days)                     and (cast ('2000-06-06' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-15' as date) - interval 30 days)                     and (cast ('1999-04-15' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-22' as date) - interval 30 days)                     and (cast ('2001-02-22' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-27' as date) - interval 30 days)                     and (cast ('2000-05-27' as date) + interval 30 days)    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 5 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'bisque' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 6 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'smoke' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_paid_inc_tax) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 9 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'rosy' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_paid_inc_tax) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 7 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'green' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_paid_inc_tax) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'pale' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 8 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'medium' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 5 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'black' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_ext_sales_price) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 9 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'thistle' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_profit) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 6 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'black' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
with ssales as (select c_last_name       ,c_first_name       ,s_store_name       ,ca_state       ,s_state       ,i_color       ,i_current_price       ,i_manager_id       ,i_units       ,i_size       ,sum(ss_net_profit) netpaid from store_sales     ,store_returns     ,store     ,item     ,customer     ,customer_address where ss_ticket_number = sr_ticket_number   and ss_item_sk = sr_item_sk   and ss_customer_sk = c_customer_sk   and ss_item_sk = i_item_sk   and ss_store_sk = s_store_sk   and c_current_addr_sk = ca_address_sk   and c_birth_country <> upper(ca_country)   and s_zip = ca_zip   and s_market_id = 10 group by c_last_name         ,c_first_name         ,s_store_name         ,ca_state         ,s_state         ,i_color         ,i_current_price         ,i_manager_id         ,i_units         ,i_size) select c_last_name       ,c_first_name       ,s_store_name       ,sum(netpaid) paid from ssales where i_color = 'lime' group by c_last_name         ,c_first_name         ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid)                            from ssales) order by c_last_name         ,c_first_name         ,s_store_name ;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'S' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'D' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'W' and        cd_education_status = 'Secondary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'S' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2002   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1999   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'W' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2001   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'M' and         cd_marital_status = 'U' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 1998   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,          avg(cs_quantity) agg1,         avg(cs_list_price) agg2,         avg(cs_coupon_amt) agg3,         avg(cs_sales_price) agg4   from catalog_sales, customer_demographics, date_dim, item, promotion  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd_demo_sk and        cs_promo_sk = p_promo_sk and        cd_gender = 'F' and         cd_marital_status = 'D' and        cd_education_status = 'Primary' and        (p_channel_email = 'N' or p_channel_event = 'N') and        d_year = 2000   group by i_item_id  order by i_item_id  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'D' and        cd_education_status = 'Unknown' and        d_year = 1998 and        s_state in ('SD','AL', 'TN', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'D' and        cd_education_status = '4 yr Degree' and        d_year = 2002 and        s_state in ('TN','AL', 'SD', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'M' and        cd_education_status = '2 yr Degree' and        d_year = 2001 and        s_state in ('TN','SD', 'AL', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'M' and        cd_education_status = 'Secondary' and        d_year = 2000 and        s_state in ('SD','TN', 'AL', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'W' and        cd_education_status = 'Primary' and        d_year = 1999 and        s_state in ('TN','AL', 'SD', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'M' and        cd_marital_status = 'S' and        cd_education_status = 'Advanced Degree' and        d_year = 2001 and        s_state in ('AL','TN', 'SD', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'S' and        cd_education_status = '4 yr Degree' and        d_year = 2000 and        s_state in ('TN','AL', 'SD', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'U' and        cd_education_status = '2 yr Degree' and        d_year = 1999 and        s_state in ('AL','SD', 'TN', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'U' and        cd_education_status = 'Secondary' and        d_year = 1998 and        s_state in ('AL','TN', 'SD', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'D' and        cd_education_status = 'Primary' and        d_year = 2002 and        s_state in ('SD','TN', 'AL', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 87 and 87+10               or ss_coupon_amt between 4024 and 4024+1000              or ss_wholesale_cost between 35 and 35+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 181 and 181+10           or ss_coupon_amt between 16785 and 16785+1000           or ss_wholesale_cost between 26 and 26+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 0 and 0+10           or ss_coupon_amt between 17729 and 17729+1000           or ss_wholesale_cost between 29 and 29+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 143 and 143+10           or ss_coupon_amt between 16894 and 16894+1000           or ss_wholesale_cost between 5 and 5+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 168 and 168+10           or ss_coupon_amt between 13924 and 13924+1000           or ss_wholesale_cost between 30 and 30+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 50 and 50+10           or ss_coupon_amt between 13008 and 13008+1000           or ss_wholesale_cost between 7 and 7+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 103 and 103+10               or ss_coupon_amt between 14149 and 14149+1000              or ss_wholesale_cost between 71 and 71+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 104 and 104+10           or ss_coupon_amt between 12519 and 12519+1000           or ss_wholesale_cost between 25 and 25+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 172 and 172+10           or ss_coupon_amt between 1646 and 1646+1000           or ss_wholesale_cost between 7 and 7+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 75 and 75+10           or ss_coupon_amt between 6535 and 6535+1000           or ss_wholesale_cost between 56 and 56+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 108 and 108+10           or ss_coupon_amt between 10409 and 10409+1000           or ss_wholesale_cost between 16 and 16+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 14 and 14+10           or ss_coupon_amt between 10140 and 10140+1000           or ss_wholesale_cost between 11 and 11+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 96 and 96+10               or ss_coupon_amt between 4 and 4+1000              or ss_wholesale_cost between 30 and 30+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 160 and 160+10           or ss_coupon_amt between 3094 and 3094+1000           or ss_wholesale_cost between 63 and 63+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 130 and 130+10           or ss_coupon_amt between 4420 and 4420+1000           or ss_wholesale_cost between 11 and 11+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 55 and 55+10           or ss_coupon_amt between 5479 and 5479+1000           or ss_wholesale_cost between 45 and 45+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 4 and 4+10           or ss_coupon_amt between 3665 and 3665+1000           or ss_wholesale_cost between 31 and 31+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 123 and 123+10           or ss_coupon_amt between 13750 and 13750+1000           or ss_wholesale_cost between 56 and 56+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 112 and 112+10               or ss_coupon_amt between 3890 and 3890+1000              or ss_wholesale_cost between 43 and 43+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 91 and 91+10           or ss_coupon_amt between 7934 and 7934+1000           or ss_wholesale_cost between 74 and 74+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 185 and 185+10           or ss_coupon_amt between 13688 and 13688+1000           or ss_wholesale_cost between 33 and 33+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 21 and 21+10           or ss_coupon_amt between 6612 and 6612+1000           or ss_wholesale_cost between 13 and 13+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 179 and 179+10           or ss_coupon_amt between 16404 and 16404+1000           or ss_wholesale_cost between 6 and 6+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 41 and 41+10           or ss_coupon_amt between 16188 and 16188+1000           or ss_wholesale_cost between 30 and 30+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 128 and 128+10               or ss_coupon_amt between 2262 and 2262+1000              or ss_wholesale_cost between 45 and 45+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 162 and 162+10           or ss_coupon_amt between 4514 and 4514+1000           or ss_wholesale_cost between 46 and 46+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 161 and 161+10           or ss_coupon_amt between 2057 and 2057+1000           or ss_wholesale_cost between 2 and 2+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 85 and 85+10           or ss_coupon_amt between 9200 and 9200+1000           or ss_wholesale_cost between 37 and 37+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 119 and 119+10           or ss_coupon_amt between 8225 and 8225+1000           or ss_wholesale_cost between 72 and 72+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 39 and 39+10           or ss_coupon_amt between 4153 and 4153+1000           or ss_wholesale_cost between 54 and 54+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 169 and 169+10               or ss_coupon_amt between 10494 and 10494+1000              or ss_wholesale_cost between 69 and 69+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 71 and 71+10           or ss_coupon_amt between 16449 and 16449+1000           or ss_wholesale_cost between 45 and 45+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 142 and 142+10           or ss_coupon_amt between 8078 and 8078+1000           or ss_wholesale_cost between 42 and 42+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 114 and 114+10           or ss_coupon_amt between 12137 and 12137+1000           or ss_wholesale_cost between 2 and 2+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 59 and 59+10           or ss_coupon_amt between 11647 and 11647+1000           or ss_wholesale_cost between 10 and 10+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 185 and 185+10           or ss_coupon_amt between 2028 and 2028+1000           or ss_wholesale_cost between 6 and 6+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 91 and 91+10               or ss_coupon_amt between 4313 and 4313+1000              or ss_wholesale_cost between 44 and 44+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 137 and 137+10           or ss_coupon_amt between 4704 and 4704+1000           or ss_wholesale_cost between 23 and 23+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 146 and 146+10           or ss_coupon_amt between 5565 and 5565+1000           or ss_wholesale_cost between 55 and 55+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 108 and 108+10           or ss_coupon_amt between 5746 and 5746+1000           or ss_wholesale_cost between 78 and 78+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 68 and 68+10           or ss_coupon_amt between 4525 and 4525+1000           or ss_wholesale_cost between 4 and 4+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 10 and 10+10           or ss_coupon_amt between 2118 and 2118+1000           or ss_wholesale_cost between 41 and 41+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 25 and 25+10               or ss_coupon_amt between 17632 and 17632+1000              or ss_wholesale_cost between 24 and 24+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 185 and 185+10           or ss_coupon_amt between 939 and 939+1000           or ss_wholesale_cost between 64 and 64+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 111 and 111+10           or ss_coupon_amt between 11268 and 11268+1000           or ss_wholesale_cost between 1 and 1+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 45 and 45+10           or ss_coupon_amt between 8313 and 8313+1000           or ss_wholesale_cost between 25 and 25+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 107 and 107+10           or ss_coupon_amt between 3792 and 3792+1000           or ss_wholesale_cost between 33 and 33+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 83 and 83+10           or ss_coupon_amt between 1717 and 1717+1000           or ss_wholesale_cost between 14 and 14+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 52 and 52+10               or ss_coupon_amt between 2828 and 2828+1000              or ss_wholesale_cost between 51 and 51+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 155 and 155+10           or ss_coupon_amt between 10867 and 10867+1000           or ss_wholesale_cost between 28 and 28+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 96 and 96+10           or ss_coupon_amt between 13327 and 13327+1000           or ss_wholesale_cost between 76 and 76+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 123 and 123+10           or ss_coupon_amt between 10106 and 10106+1000           or ss_wholesale_cost between 54 and 54+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 9 and 9+10           or ss_coupon_amt between 1734 and 1734+1000           or ss_wholesale_cost between 59 and 59+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 10 and 10+10           or ss_coupon_amt between 17254 and 17254+1000           or ss_wholesale_cost between 47 and 47+20)) B6 limit 100;
select  * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 162 and 162+10               or ss_coupon_amt between 1097 and 1097+1000              or ss_wholesale_cost between 6 and 6+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 125 and 125+10           or ss_coupon_amt between 14876 and 14876+1000           or ss_wholesale_cost between 7 and 7+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 32 and 32+10           or ss_coupon_amt between 10346 and 10346+1000           or ss_wholesale_cost between 77 and 77+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 129 and 129+10           or ss_coupon_amt between 4488 and 4488+1000           or ss_wholesale_cost between 74 and 74+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 44 and 44+10           or ss_coupon_amt between 3291 and 3291+1000           or ss_wholesale_cost between 2 and 2+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 145 and 145+10           or ss_coupon_amt between 7550 and 7550+1000           or ss_wholesale_cost between 37 and 37+20)) B6 limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 628 and i_item_sk = cs_item_sk  and d_date between '2002-03-31' and          (cast('2002-03-31' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2002-03-31' and                              (cast('2002-03-31' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 701 and i_item_sk = cs_item_sk  and d_date between '1999-03-13' and          (cast('1999-03-13' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1999-03-13' and                              (cast('1999-03-13' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 127 and i_item_sk = cs_item_sk  and d_date between '2001-02-21' and          (cast('2001-02-21' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2001-02-21' and                              (cast('2001-02-21' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 553 and i_item_sk = cs_item_sk  and d_date between '1998-02-03' and          (cast('1998-02-03' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1998-02-03' and                              (cast('1998-02-03' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 979 and i_item_sk = cs_item_sk  and d_date between '2000-01-16' and          (cast('2000-01-16' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2000-01-16' and                              (cast('2000-01-16' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 52 and i_item_sk = cs_item_sk  and d_date between '2002-02-15' and          (cast('2002-02-15' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2002-02-15' and                              (cast('2002-02-15' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 478 and i_item_sk = cs_item_sk  and d_date between '1999-01-28' and          (cast('1999-01-28' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1999-01-28' and                              (cast('1999-01-28' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 904 and i_item_sk = cs_item_sk  and d_date between '2001-01-09' and          (cast('2001-01-09' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2001-01-09' and                              (cast('2001-01-09' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 330 and i_item_sk = cs_item_sk  and d_date between '1998-03-21' and          (cast('1998-03-21' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '1998-03-21' and                              (cast('1998-03-21' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
select  sum(cs_ext_discount_amt)  as excess_discount_amount from     catalog_sales     ,item     ,date_dim where i_manufact_id = 403 and i_item_sk = cs_item_sk  and d_date between '2000-03-15' and          (cast('2000-03-15' as date) + interval 90 days) and d_date_sk = cs_sold_date_sk  and cs_ext_discount_amt        > (           select              1.3 * avg(cs_ext_discount_amt)           from              catalog_sales             ,date_dim          where                cs_item_sk = i_item_sk            and d_date between '2000-03-15' and                              (cast('2000-03-15' as date) + interval 90 days)           and d_date_sk = cs_sold_date_sk        )  limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Electronics'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Books'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Sports'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 6  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 6  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 6  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Books'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Books'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select  i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Ziebach County','Walker County','Williamson County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   sum(cd_dep_count),   min(cd_dep_count),   min(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   sum(cd_dep_employed_count),   min(cd_dep_employed_count),   min(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   sum(cd_dep_college_count),   min(cd_dep_college_count),   min(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   stddev_samp(cd_dep_count),   sum(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   stddev_samp(cd_dep_employed_count),   sum(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   stddev_samp(cd_dep_college_count),   sum(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   avg(cd_dep_count),   avg(cd_dep_count),   max(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   avg(cd_dep_employed_count),   avg(cd_dep_employed_count),   max(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   avg(cd_dep_college_count),   avg(cd_dep_college_count),   max(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   min(cd_dep_count),   sum(cd_dep_count),   stddev_samp(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   min(cd_dep_employed_count),   sum(cd_dep_employed_count),   stddev_samp(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   min(cd_dep_college_count),   sum(cd_dep_college_count),   stddev_samp(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   stddev_samp(cd_dep_count),   min(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   stddev_samp(cd_dep_employed_count),   min(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   stddev_samp(cd_dep_college_count),   min(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   avg(cd_dep_count),   avg(cd_dep_count),   avg(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   avg(cd_dep_employed_count),   avg(cd_dep_employed_count),   avg(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   avg(cd_dep_college_count),   avg(cd_dep_college_count),   avg(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   stddev_samp(cd_dep_count),   max(cd_dep_count),   sum(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   stddev_samp(cd_dep_employed_count),   max(cd_dep_employed_count),   sum(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   stddev_samp(cd_dep_college_count),   max(cd_dep_college_count),   sum(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   avg(cd_dep_count),   sum(cd_dep_count),   stddev_samp(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   avg(cd_dep_employed_count),   sum(cd_dep_employed_count),   stddev_samp(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   avg(cd_dep_college_count),   sum(cd_dep_college_count),   stddev_samp(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   stddev_samp(cd_dep_count),   stddev_samp(cd_dep_count),   min(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   stddev_samp(cd_dep_employed_count),   stddev_samp(cd_dep_employed_count),   min(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   stddev_samp(cd_dep_college_count),   stddev_samp(cd_dep_college_count),   min(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2000 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2000 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select      ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   sum(cd_dep_count),   avg(cd_dep_count),   avg(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   sum(cd_dep_employed_count),   avg(cd_dep_employed_count),   avg(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   sum(cd_dep_college_count),   avg(cd_dep_college_count),   avg(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 1999 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 1999 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 41 and 41 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-03-23' as date) and (cast('2000-03-23' as date) + interval 60 days)  and i_manufact_id in (778,777,716,870)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 12 and 12 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-05-08' as date) and (cast('2000-05-08' as date) + interval 60 days)  and i_manufact_id in (743,910,835,671)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 44 and 44 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-01-03' as date) and (cast('1998-01-03' as date) + interval 60 days)  and i_manufact_id in (705,684,863,843)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 15 and 15 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-01-06' as date) and (cast('1998-01-06' as date) + interval 60 days)  and i_manufact_id in (864,880,671,995)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 47 and 47 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-01-08' as date) and (cast('2001-01-08' as date) + interval 60 days)  and i_manufact_id in (891,688,690,698)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 18 and 18 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-01-10' as date) and (cast('2001-01-10' as date) + interval 60 days)  and i_manufact_id in (897,939,949,742)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 50 and 50 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-02-01' as date) and (cast('2001-02-01' as date) + interval 60 days)  and i_manufact_id in (824,937,972,793)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 21 and 21 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-02-03' as date) and (cast('1999-02-03' as date) + interval 60 days)  and i_manufact_id in (917,755,879,816)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 53 and 53 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-02-06' as date) and (cast('1999-02-06' as date) + interval 60 days)  and i_manufact_id in (676,861,855,762)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 24 and 24 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-02-28' as date) and (cast('2002-02-28' as date) + interval 60 days)  and i_manufact_id in (769,948,998,789)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2001-05-02' as date) - interval 30 days)                 and (cast ('2001-05-02' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-06-21' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-06-21' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2000-06-21' as date) - interval 30 days)                 and (cast ('2000-06-21' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1999-03-07' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1999-03-07' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('1999-03-07' as date) - interval 30 days)                 and (cast ('1999-03-07' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1998-06-14' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1998-06-14' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('1998-06-14' as date) - interval 30 days)                 and (cast ('1998-06-14' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-06-11' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-06-11' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2000-06-11' as date) - interval 30 days)                 and (cast ('2000-06-11' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2002-03-03' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2002-03-03' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2002-03-03' as date) - interval 30 days)                 and (cast ('2002-03-03' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-06-06' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-06-06' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2000-06-06' as date) - interval 30 days)                 and (cast ('2000-06-06' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('1999-04-15' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('1999-04-15' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('1999-04-15' as date) - interval 30 days)                 and (cast ('1999-04-15' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2001-02-22' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2001-02-22' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2001-02-22' as date) - interval 30 days)                 and (cast ('2001-02-22' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select      w_state   ,i_item_id   ,sum(case when (cast(d_date as date) < cast ('2000-05-27' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before   ,sum(case when (cast(d_date as date) >= cast ('2000-05-27' as date))   		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after  from    catalog_sales left outer join catalog_returns on        (cs_order_number = cr_order_number          and cs_item_sk = cr_item_sk)   ,warehouse    ,item   ,date_dim  where      i_current_price between 0.99 and 1.49  and i_item_sk          = cs_item_sk  and cs_warehouse_sk    = w_warehouse_sk   and cs_sold_date_sk    = d_date_sk  and d_date between (cast ('2000-05-27' as date) - interval 30 days)                 and (cast ('2000-05-27' as date) + interval 30 days)   group by     w_state,i_item_id  order by w_state,i_item_id limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 893 and 893+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'lime' or i_color = 'sandy') and          (i_units = 'Ounce' or i_units = 'Cup') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'lemon' or i_color = 'snow') and         (i_units = 'Carton' or i_units = 'Gross') and         (i_size = 'extra large' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'wheat' or i_color = 'lawn') and         (i_units = 'Ton' or i_units = 'Pallet') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'blanched' or i_color = 'aquamarine') and         (i_units = 'Lb' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'floral' or i_color = 'ivory') and          (i_units = 'Oz' or i_units = 'Bunch') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'cream' or i_color = 'honeydew') and         (i_units = 'Unknown' or i_units = 'Each') and         (i_size = 'extra large' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'pale' or i_color = 'coral') and         (i_units = 'Gram' or i_units = 'N/A') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'steel' or i_color = 'misty') and         (i_units = 'Case' or i_units = 'Dram') and         (i_size = 'small' or i_size = 'petite')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 1000 and 1000+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'deep' or i_color = 'lavender') and          (i_units = 'Bundle' or i_units = 'Box') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'forest' or i_color = 'almond') and         (i_units = 'Ton' or i_units = 'Cup') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'red' or i_color = 'drab') and         (i_units = 'Bunch' or i_units = 'Dozen') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'royal' or i_color = 'burnished') and         (i_units = 'Tbl' or i_units = 'Gross') and         (i_size = 'small' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'hot' or i_color = 'grey') and          (i_units = 'Unknown' or i_units = 'Ounce') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'light' or i_color = 'cyan') and         (i_units = 'Case' or i_units = 'Oz') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'aquamarine' or i_color = 'beige') and         (i_units = 'Pallet' or i_units = 'Dram') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'midnight' or i_color = 'orange') and         (i_units = 'Gram' or i_units = 'Carton') and         (i_size = 'small' or i_size = 'petite')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 773 and 773+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'goldenrod' or i_color = 'orange') and          (i_units = 'Carton' or i_units = 'Box') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'honeydew' or i_color = 'sienna') and         (i_units = 'Ton' or i_units = 'Case') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'mint' or i_color = 'navy') and         (i_units = 'Gram' or i_units = 'Lb') and         (i_size = 'small' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'white' or i_color = 'antique') and         (i_units = 'Oz' or i_units = 'Gross') and         (i_size = 'petite' or i_size = 'economy')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'metallic' or i_color = 'khaki') and          (i_units = 'Pound' or i_units = 'Cup') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'floral' or i_color = 'deep') and         (i_units = 'Bunch' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'magenta' or i_color = 'firebrick') and         (i_units = 'Dram' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'chiffon' or i_color = 'ghost') and         (i_units = 'N/A' or i_units = 'Unknown') and         (i_size = 'petite' or i_size = 'economy')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 880 and 880+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'forest' or i_color = 'snow') and          (i_units = 'Case' or i_units = 'Box') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Women' and         (i_color = 'cyan' or i_color = 'peach') and         (i_units = 'Lb' or i_units = 'Bundle') and         (i_size = 'economy' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'cornflower' or i_color = 'burnished') and         (i_units = 'Dram' or i_units = 'Pallet') and         (i_size = 'N/A' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'bisque' or i_color = 'olive') and         (i_units = 'Tbl' or i_units = 'Bunch') and         (i_size = 'small' or i_size = 'large')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'tan' or i_color = 'magenta') and          (i_units = 'Carton' or i_units = 'Ounce') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Women' and         (i_color = 'lemon' or i_color = 'pale') and         (i_units = 'Dozen' or i_units = 'Each') and         (i_size = 'economy' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'mint' or i_color = 'dim') and         (i_units = 'Gross' or i_units = 'N/A') and         (i_size = 'N/A' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'tomato' or i_color = 'lime') and         (i_units = 'Oz' or i_units = 'Pound') and         (i_size = 'small' or i_size = 'large')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 987 and 987+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'goldenrod' or i_color = 'powder') and          (i_units = 'Tsp' or i_units = 'Box') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'blue' or i_color = 'puff') and         (i_units = 'Bunch' or i_units = 'Gram') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'tan' or i_color = 'ghost') and         (i_units = 'Bundle' or i_units = 'Pallet') and         (i_size = 'extra large' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'pale' or i_color = 'olive') and         (i_units = 'Case' or i_units = 'Ton') and         (i_size = 'large' or i_size = 'N/A')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'lace' or i_color = 'steel') and          (i_units = 'Dozen' or i_units = 'Cup') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'firebrick' or i_color = 'maroon') and         (i_units = 'Ounce' or i_units = 'Pound') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'smoke' or i_color = 'linen') and         (i_units = 'Unknown' or i_units = 'Tbl') and         (i_size = 'extra large' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'chocolate' or i_color = 'mint') and         (i_units = 'Each' or i_units = 'N/A') and         (i_size = 'large' or i_size = 'N/A')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 760 and 760+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'bisque' or i_color = 'pale') and          (i_units = 'Box' or i_units = 'Unknown') and         (i_size = 'medium' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'floral' or i_color = 'blue') and         (i_units = 'Ounce' or i_units = 'Dram') and         (i_size = 'economy' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'lawn' or i_color = 'dark') and         (i_units = 'Cup' or i_units = 'N/A') and         (i_size = 'extra large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'lace' or i_color = 'coral') and         (i_units = 'Gross' or i_units = 'Case') and         (i_size = 'medium' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'dodger' or i_color = 'orchid') and          (i_units = 'Bundle' or i_units = 'Pound') and         (i_size = 'medium' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'beige' or i_color = 'cornsilk') and         (i_units = 'Ton' or i_units = 'Dozen') and         (i_size = 'economy' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'thistle' or i_color = 'ivory') and         (i_units = 'Gram' or i_units = 'Carton') and         (i_size = 'extra large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'blanched' or i_color = 'cream') and         (i_units = 'Oz' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'small')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 867 and 867+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'yellow' or i_color = 'ghost') and          (i_units = 'Box' or i_units = 'Bunch') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'cream' or i_color = 'burlywood') and         (i_units = 'Lb' or i_units = 'Unknown') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'drab' or i_color = 'steel') and         (i_units = 'Oz' or i_units = 'Gross') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'magenta' or i_color = 'coral') and         (i_units = 'Pallet' or i_units = 'Pound') and         (i_size = 'N/A' or i_size = 'economy')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'papaya' or i_color = 'lime') and          (i_units = 'Dram' or i_units = 'Each') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'rosy' or i_color = 'grey') and         (i_units = 'Case' or i_units = 'Gram') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'white' or i_color = 'frosted') and         (i_units = 'Ton' or i_units = 'Tbl') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'antique' or i_color = 'metallic') and         (i_units = 'Ounce' or i_units = 'Tsp') and         (i_size = 'N/A' or i_size = 'economy')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 974 and 974+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'cornflower' or i_color = 'magenta') and          (i_units = 'Unknown' or i_units = 'Bunch') and         (i_size = 'petite' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'azure' or i_color = 'burnished') and         (i_units = 'Ounce' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'medium' or i_color = 'spring') and         (i_units = 'Case' or i_units = 'Box') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'powder' or i_color = 'mint') and         (i_units = 'Lb' or i_units = 'Gram') and         (i_size = 'petite' or i_size = 'N/A')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'cyan' or i_color = 'rose') and          (i_units = 'Ton' or i_units = 'Carton') and         (i_size = 'petite' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'antique' or i_color = 'saddle') and         (i_units = 'Cup' or i_units = 'N/A') and         (i_size = 'small' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'royal' or i_color = 'almond') and         (i_units = 'Tbl' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'sky' or i_color = 'drab') and         (i_units = 'Bundle' or i_units = 'Dram') and         (i_size = 'petite' or i_size = 'N/A')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 747 and 747+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'spring' or i_color = 'saddle') and          (i_units = 'Carton' or i_units = 'Lb') and         (i_size = 'large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'deep' or i_color = 'drab') and         (i_units = 'Bundle' or i_units = 'Ton') and         (i_size = 'extra large' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'steel' or i_color = 'lace') and         (i_units = 'Dram' or i_units = 'Ounce') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'rose' or i_color = 'orchid') and         (i_units = 'Case' or i_units = 'Each') and         (i_size = 'large' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'gainsboro' or i_color = 'slate') and          (i_units = 'Dozen' or i_units = 'N/A') and         (i_size = 'large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'navy' or i_color = 'papaya') and         (i_units = 'Tsp' or i_units = 'Pallet') and         (i_size = 'extra large' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'lime' or i_color = 'lavender') and         (i_units = 'Tbl' or i_units = 'Oz') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'orange' or i_color = 'green') and         (i_units = 'Unknown' or i_units = 'Box') and         (i_size = 'large' or i_size = 'small')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 854 and 854+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'azure' or i_color = 'goldenrod') and          (i_units = 'Tsp' or i_units = 'Each') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'ivory' or i_color = 'olive') and         (i_units = 'Pallet' or i_units = 'Gram') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'powder' or i_color = 'linen') and         (i_units = 'Box' or i_units = 'Carton') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'peru' or i_color = 'salmon') and         (i_units = 'Tbl' or i_units = 'Pound') and         (i_size = 'extra large' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'metallic' or i_color = 'navajo') and          (i_units = 'Bunch' or i_units = 'Dram') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'lime' or i_color = 'tomato') and         (i_units = 'Bundle' or i_units = 'Lb') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'chartreuse' or i_color = 'floral') and         (i_units = 'N/A' or i_units = 'Cup') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'dim' or i_color = 'blush') and         (i_units = 'Ounce' or i_units = 'Unknown') and         (i_size = 'extra large' or i_size = 'small')         )))) > 0  order by i_product_name  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 3 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Riverside','Five Points','Oak Grove','Midway','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 6 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Five Points','Oak Grove','Fairview','Pleasant Hill','Midway')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 2 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Pleasant Hill','Fairview','Riverside','Midway','Oak Grove')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 8 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Fairview','Five Points','Riverside','Pleasant Hill','Midway')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 4 or          household_demographics.hd_vehicle_count= 1)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Five Points','Pleasant Hill','Fairview','Midway','Oak Grove')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 7 or          household_demographics.hd_vehicle_count= 0)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Midway','Pleasant Hill','Fairview','Oak Grove','Five Points')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 3 or          household_demographics.hd_vehicle_count= 0)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Fairview','Five Points','Pleasant Hill','Oak Grove','Midway')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 9 or          household_demographics.hd_vehicle_count= 0)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_city in ('Riverside','Pleasant Hill','Midway','Fairview','Oak Grove')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 2 or          household_demographics.hd_vehicle_count= 0)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_city in ('Oak Grove','Five Points','Pleasant Hill','Midway','Fairview')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,ca_city bought_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics,customer_address      where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and store_sales.ss_addr_sk = customer_address.ca_address_sk     and (household_demographics.hd_dep_count = 8 or          household_demographics.hd_vehicle_count= 0)     and date_dim.d_dow in (6,0)     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_city in ('Midway','Fairview','Riverside','Five Points','Oak Grove')      group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr     where ss_customer_sk = c_customer_sk       and customer.c_current_addr_sk = current_addr.ca_address_sk       and current_addr.ca_city <> bought_city   order by c_last_name           ,c_first_name           ,ca_city           ,bought_city           ,ss_ticket_number   limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_company_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_brand         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_store_name, v1.s_company_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, nsum  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         s_store_name, s_company_name,         d_year, d_moy,         sum(ss_sales_price) sum_sales,         avg(sum(ss_sales_price)) over           (partition by i_category, i_brand,                      s_store_name, s_company_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      s_store_name, s_company_name            order by d_year, d_moy) rn  from item, store_sales, date_dim, store  where ss_item_sk = i_item_sk and        ss_sold_date_sk = d_date_sk and        ss_store_sk = s_store_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           s_store_name, s_company_name,           d_year, d_moy),  v2 as(  select v1.s_store_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1.s_store_name = v1_lag.s_store_name and        v1.s_store_name = v1_lead.s_store_name and        v1.s_company_name = v1_lag.s_company_name and        v1.s_company_name = v1_lead.s_company_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and             avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2002  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'College'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'W'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('OK', 'KY', 'IN')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WI', 'CO', 'MI')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('SC', 'MO', 'ID')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1999  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'W'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('KY', 'VA', 'WV')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('MN', 'CO', 'KS')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NE', 'SC', 'MS')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = 'College'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = 'Unknown'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('VA', 'OH', 'GA')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('AR', 'RI', 'WA')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('PA', 'OR', 'OK')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1998  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'S'    and     cd_education_status = 'Primary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('TX', 'AL', 'AR')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NY', 'FL', 'WI')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('LA', 'KS', 'MO')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = 'College'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'S'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WV', 'SC', 'MO')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('OH', 'UT', 'OK')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('PA', 'CO', 'MI')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2002  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('AR', 'IL', 'IA')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('CO', 'KY', 'CA')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('MN', 'MS', 'PA')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1999  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'U'    and     cd_education_status = 'Primary'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'D'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('AL', 'KS', 'NH')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('MI', 'OH', 'GA')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('ID', 'CA', 'IL')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2001  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'S'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('KY', 'KS', 'MO')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('WV', 'MI', 'MS')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('CA', 'SC', 'TN')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 1998  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'M'    and     cd_education_status = 'Advanced Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = '2 yr Degree'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'U'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NY', 'NC', 'HI')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('CO', 'VA', 'GA')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NE', 'AL', 'TX')   and ss_net_profit between 50 and 25000    )  ) ;
select sum (ss_quantity)  from store_sales, store, customer_demographics, customer_address, date_dim  where s_store_sk = ss_store_sk  and  ss_sold_date_sk = d_date_sk and d_year = 2000  and    (   (    cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'D'    and     cd_education_status = '4 yr Degree'    and     ss_sales_price between 100.00 and 150.00      )  or   (   cd_demo_sk = ss_cdemo_sk    and     cd_marital_status = 'W'    and     cd_education_status = 'College'    and     ss_sales_price between 50.00 and 100.00      )  or   (   cd_demo_sk = ss_cdemo_sk   and     cd_marital_status = 'M'    and     cd_education_status = 'Secondary'    and     ss_sales_price between 150.00 and 200.00    )  )  and  (   (   ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('ME', 'MD', 'LA')   and ss_net_profit between 0 and 2000     )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('GA', 'WV', 'KY')   and ss_net_profit between 150 and 3000    )  or   (ss_addr_sk = ca_address_sk   and   ca_country = 'United States'   and   ca_state in ('NE', 'PA', 'VA')   and ss_net_profit between 50 and 25000    )  ) ;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Music'          and i_class = 'classical'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 2          and d_year = 2002  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2002 and d_moy = 2)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2002 and d_moy = 2)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Men'          and i_class = 'accessories'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 4          and d_year = 1998  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1998 and d_moy = 4)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1998 and d_moy = 4)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Books'          and i_class = 'parenting'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 5          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 5)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 5)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Jewelry'          and i_class = 'pendants'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 6          and d_year = 2002  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2002 and d_moy = 6)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2002 and d_moy = 6)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Children'          and i_class = 'school-uniforms'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 7          and d_year = 2000  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2000 and d_moy = 7)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2000 and d_moy = 7)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Electronics'          and i_class = 'memory'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 2          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 2)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 2)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Home'          and i_class = 'accent'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 3          and d_year = 1999  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1999 and d_moy = 3)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1999 and d_moy = 3)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Shoes'          and i_class = 'athletic'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 4          and d_year = 2002  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2002 and d_moy = 4)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2002 and d_moy = 4)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Women'          and i_class = 'dresses'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 5          and d_year = 1998  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 1998 and d_moy = 5)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 1998 and d_moy = 5)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
with my_customers as (  select distinct c_customer_sk         , c_current_addr_sk  from            ( select cs_sold_date_sk sold_date_sk,                  cs_bill_customer_sk customer_sk,                  cs_item_sk item_sk           from   catalog_sales           union all           select ws_sold_date_sk sold_date_sk,                  ws_bill_customer_sk customer_sk,                  ws_item_sk item_sk           from   web_sales          ) cs_or_ws_sales,          item,          date_dim,          customer  where   sold_date_sk = d_date_sk          and item_sk = i_item_sk          and i_category = 'Sports'          and i_class = 'tennis'          and c_customer_sk = cs_or_ws_sales.customer_sk          and d_moy = 7          and d_year = 2001  )  , my_revenue as (  select c_customer_sk,         sum(ss_ext_sales_price) as revenue  from   my_customers,         store_sales,         customer_address,         store,         date_dim  where  c_current_addr_sk = ca_address_sk         and ca_county = s_county         and ca_state = s_state         and ss_sold_date_sk = d_date_sk         and c_customer_sk = ss_customer_sk         and d_month_seq between (select distinct d_month_seq+1                                  from   date_dim where d_year = 2001 and d_moy = 7)                            and  (select distinct d_month_seq+3                                  from   date_dim where d_year = 2001 and d_moy = 7)  group by c_customer_sk  )  , segments as  (select cast((revenue/50) as int) as segment   from   my_revenue  )   select  segment, count(*) as num_customers, segment*50 as segment_base  from segments  group by segment  order by segment, num_customers  limit 100;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=15  	and d_moy=12  	and d_year=2000  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=22  	and d_moy=11  	and d_year=1998  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=29  	and d_moy=12  	and d_year=1999  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=36  	and d_moy=11  	and d_year=2000  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=43  	and d_moy=12  	and d_year=2001  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=57  	and d_moy=11  	and d_year=2000  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=64  	and d_moy=12  	and d_year=2001  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=71  	and d_moy=11  	and d_year=2002  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=78  	and d_moy=12  	and d_year=2000  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
select  i_brand_id brand_id, i_brand brand,  	sum(ss_ext_sales_price) ext_price  from date_dim, store_sales, item  where d_date_sk = ss_sold_date_sk  	and ss_item_sk = i_item_sk  	and i_manager_id=85  	and d_moy=11  	and d_year=2001  group by i_brand, i_brand_id  order by ext_price desc, i_brand_id limit 100 ;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('coral','cream','black'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 6  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('coral','cream','black'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 6  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('coral','cream','black'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 6  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('aquamarine','bisque','beige'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('aquamarine','bisque','beige'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('aquamarine','bisque','beige'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('papaya','lime','pink'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 2  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('papaya','lime','pink'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 2  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('papaya','lime','pink'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 2  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('black','smoke','medium'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('black','smoke','medium'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('black','smoke','medium'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('moccasin','rosy','indian'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('moccasin','rosy','indian'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('moccasin','rosy','indian'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 5  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('burnished','green','dark'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('burnished','green','dark'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('burnished','green','dark'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 7  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('violet','pale','rose'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('violet','pale','rose'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('violet','pale','rose'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('sandy','medium','azure'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 3  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('sandy','medium','azure'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 3  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('sandy','medium','azure'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 3  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('gainsboro','black','midnight'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 4  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('gainsboro','black','midnight'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 4  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('gainsboro','black','midnight'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 4  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with ss as (  select i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where i_item_id in (select      i_item_id from item where i_color in ('tomato','thistle','medium'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('tomato','thistle','medium'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from item where i_color in ('tomato','thistle','medium'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 6  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select  i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by total_sales,           i_item_id  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.cc_name         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, psum  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 1999 or          ( d_year = 1999-1 and d_moy =12) or          ( d_year = 1999+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 1999 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.cc_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.cc_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2000 or          ( d_year = 2000-1 and d_moy =12) or          ( d_year = 2000+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category, v1.i_brand, v1.cc_name         ,v1.d_year, v1.d_moy         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2000 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, sum_sales  limit 100;
with v1 as(  select i_category, i_brand,         cc_name,         d_year, d_moy,         sum(cs_sales_price) sum_sales,         avg(sum(cs_sales_price)) over           (partition by i_category, i_brand,                      cc_name, d_year)           avg_monthly_sales,         rank() over           (partition by i_category, i_brand,                      cc_name            order by d_year, d_moy) rn  from item, catalog_sales, date_dim, call_center  where cs_item_sk = i_item_sk and        cs_sold_date_sk = d_date_sk and        cc_call_center_sk= cs_call_center_sk and        (          d_year = 2001 or          ( d_year = 2001-1 and d_moy =12) or          ( d_year = 2001+1 and d_moy =1)        )  group by i_category, i_brand,           cc_name , d_year, d_moy),  v2 as(  select v1.i_category         ,v1.d_year         ,v1.avg_monthly_sales         ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum  from v1, v1 v1_lag, v1 v1_lead  where v1.i_category = v1_lag.i_category and        v1.i_category = v1_lead.i_category and        v1.i_brand = v1_lag.i_brand and        v1.i_brand = v1_lead.i_brand and        v1. cc_name = v1_lag. cc_name and        v1. cc_name = v1_lead. cc_name and        v1.rn = v1_lag.rn + 1 and        v1.rn = v1_lead.rn - 1)   select  *  from v2  where  d_year = 2001 and         avg_monthly_sales > 0 and         case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1  order by sum_sales - avg_monthly_sales, avg_monthly_sales  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-05-06'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-05-06'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2002-05-06'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-01-09'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-01-09'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1999-01-09'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-04-05'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-04-05'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2001-04-05'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-06-30'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-06-30'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1998-06-30'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-01-28'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-01-28'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2000-01-28'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-06-20'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2002-06-20'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2002-06-20'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-02-23'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1999-02-23'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1999-02-23'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-05-20'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-05-20'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2001-05-20'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-01-23'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '1998-01-23'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '1998-01-23'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-05-08'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2000-05-08'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2000-05-08'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select  ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by item_id          ,ss_item_rev  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Children'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Music'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1998  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Men'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Shoes'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -8   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -8   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Shoes'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -8  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 8  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 8  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 8  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Men'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Children'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 1999  and     d_moy                   = 10  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Jewelry'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -6  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Music'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Music'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2001  and     d_moy                   = 9  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Men'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Men'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_item_id)   select      i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('UPS'  , ',' , 'ALLIANCE') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_ext_list_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_ext_list_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_ext_list_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_ext_list_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_ext_list_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_ext_list_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_ext_list_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_ext_list_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_ext_list_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_ext_list_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_ext_list_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_ext_list_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_profit * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_profit * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_profit * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_profit * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_profit * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_profit * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_profit * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_profit * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_profit * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_profit * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_profit * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_profit * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1998  	and t_time between 46442 and 46442+28800   	and sm_carrier in ('UPS','ALLIANCE')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('UPS'  , ',' , 'ALLIANCE') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1998  	and t_time between 46442 AND 46442+28800   	and sm_carrier in ('UPS','ALLIANCE')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('BARIAN'  , ',' , 'MSC') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  	and t_time between 11150 and 11150+28800   	and sm_carrier in ('BARIAN','MSC')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('BARIAN'  , ',' , 'MSC') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_ext_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  	and t_time between 11150 AND 11150+28800   	and sm_carrier in ('BARIAN','MSC')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('DIAMOND'  , ',' , 'GREAT EASTERN') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_ext_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  	and t_time between 33455 and 33455+28800   	and sm_carrier in ('DIAMOND','GREAT EASTERN')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('DIAMOND'  , ',' , 'GREAT EASTERN') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_ext_list_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_ext_list_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_ext_list_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_ext_list_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_ext_list_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_ext_list_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_ext_list_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_ext_list_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_ext_list_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_ext_list_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_ext_list_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_ext_list_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  	and t_time between 33455 AND 33455+28800   	and sm_carrier in ('DIAMOND','GREAT EASTERN')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('GREAT EASTERN'  , ',' , 'GERMA') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_ext_list_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_ext_list_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_ext_list_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_ext_list_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_ext_list_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_ext_list_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_ext_list_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_ext_list_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_ext_list_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_ext_list_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_ext_list_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_ext_list_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_profit * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_profit * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_profit * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_profit * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_profit * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_profit * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_profit * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_profit * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_profit * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_profit * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_profit * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_profit * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1998  	and t_time between 35262 and 35262+28800   	and sm_carrier in ('GREAT EASTERN','GERMA')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('GREAT EASTERN'  , ',' , 'GERMA') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1998  	and t_time between 35262 AND 35262+28800   	and sm_carrier in ('GREAT EASTERN','GERMA')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('HARMSTORF'  , ',' , 'TBS') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  	and t_time between 57567 and 57567+28800   	and sm_carrier in ('HARMSTORF','TBS')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('HARMSTORF'  , ',' , 'TBS') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_ext_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  	and t_time between 57567 AND 57567+28800   	and sm_carrier in ('HARMSTORF','TBS')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('ORIENTAL'  , ',' , 'USPS') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  	and t_time between 22275 and 22275+28800   	and sm_carrier in ('ORIENTAL','USPS')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('ORIENTAL'  , ',' , 'USPS') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_ext_list_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_ext_list_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_ext_list_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_ext_list_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_ext_list_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_ext_list_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_ext_list_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_ext_list_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_ext_list_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_ext_list_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_ext_list_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_ext_list_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_tax * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_tax * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2002  	and t_time between 22275 AND 22275+28800   	and sm_carrier in ('ORIENTAL','USPS')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('FEDEX'  , ',' , 'ALLIANCE') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_ext_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2000  	and t_time between 44580 and 44580+28800   	and sm_carrier in ('FEDEX','ALLIANCE')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('FEDEX'  , ',' , 'ALLIANCE') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2000  	and t_time between 44580 AND 44580+28800   	and sm_carrier in ('FEDEX','ALLIANCE')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('DHL'  , ',' , 'FEDEX') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_ext_list_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_ext_list_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_ext_list_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_ext_list_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_ext_list_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_ext_list_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_ext_list_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_ext_list_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_ext_list_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_ext_list_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_ext_list_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_ext_list_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_profit * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_profit * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_profit * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_profit * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_profit * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_profit * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_profit * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_profit * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_profit * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_profit * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_profit * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_profit * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  	and t_time between 9288 and 9288+28800   	and sm_carrier in ('DHL','FEDEX')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('DHL'  , ',' , 'FEDEX') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_ext_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2001  	and t_time between 9288 AND 9288+28800   	and sm_carrier in ('DHL','FEDEX')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('GREAT EASTERN'  , ',' , 'BARIAN') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  	and t_time between 31593 and 31593+28800   	and sm_carrier in ('GREAT EASTERN','BARIAN')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('GREAT EASTERN'  , ',' , 'BARIAN') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_ext_list_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_ext_list_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_ext_list_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_ext_list_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_ext_list_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_ext_list_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_ext_list_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_ext_list_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_ext_list_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_ext_list_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_ext_list_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_ext_list_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_profit * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_profit * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_profit * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_profit * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_profit * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_profit * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_profit * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_profit * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_profit * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_profit * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_profit * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_profit * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 1999  	and t_time between 31593 AND 31593+28800   	and sm_carrier in ('GREAT EASTERN','BARIAN')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select             w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,ship_carriers         ,year  	,sum(jan_sales) as jan_sales  	,sum(feb_sales) as feb_sales  	,sum(mar_sales) as mar_sales  	,sum(apr_sales) as apr_sales  	,sum(may_sales) as may_sales  	,sum(jun_sales) as jun_sales  	,sum(jul_sales) as jul_sales  	,sum(aug_sales) as aug_sales  	,sum(sep_sales) as sep_sales  	,sum(oct_sales) as oct_sales  	,sum(nov_sales) as nov_sales  	,sum(dec_sales) as dec_sales  	,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot  	,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot  	,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot  	,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot  	,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot  	,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot  	,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot  	,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot  	,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot  	,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot  	,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot  	,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot  	,sum(jan_net) as jan_net  	,sum(feb_net) as feb_net  	,sum(mar_net) as mar_net  	,sum(apr_net) as apr_net  	,sum(may_net) as may_net  	,sum(jun_net) as jun_net  	,sum(jul_net) as jul_net  	,sum(aug_net) as aug_net  	,sum(sep_net) as sep_net  	,sum(oct_net) as oct_net  	,sum(nov_net) as nov_net  	,sum(dec_net) as dec_net  from (      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('GERMA'  , ',' , 'AIRBORNE') as ship_carriers        ,d_year as year  	,sum(case when d_moy = 1   		then ws_ext_sales_price* ws_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then ws_ext_sales_price* ws_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then ws_ext_sales_price* ws_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then ws_ext_sales_price* ws_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then ws_ext_sales_price* ws_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then ws_ext_sales_price* ws_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then ws_ext_sales_price* ws_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then ws_ext_sales_price* ws_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then ws_ext_sales_price* ws_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then ws_ext_sales_price* ws_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then ws_ext_sales_price* ws_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then ws_ext_sales_price* ws_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net      from           web_sales          ,warehouse          ,date_dim          ,time_dim  	  ,ship_mode      where             ws_warehouse_sk =  w_warehouse_sk         and ws_sold_date_sk = d_date_sk         and ws_sold_time_sk = t_time_sk  	and ws_ship_mode_sk = sm_ship_mode_sk         and d_year = 2000  	and t_time between 33400 and 33400+28800   	and sm_carrier in ('GERMA','AIRBORNE')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  union all      select   	w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country         ,concat('GERMA'  , ',' , 'AIRBORNE') as ship_carriers 	,d_year as year  	,sum(case when d_moy = 1   		then cs_sales_price* cs_quantity else 0 end) as jan_sales  	,sum(case when d_moy = 2   		then cs_sales_price* cs_quantity else 0 end) as feb_sales  	,sum(case when d_moy = 3   		then cs_sales_price* cs_quantity else 0 end) as mar_sales  	,sum(case when d_moy = 4   		then cs_sales_price* cs_quantity else 0 end) as apr_sales  	,sum(case when d_moy = 5   		then cs_sales_price* cs_quantity else 0 end) as may_sales  	,sum(case when d_moy = 6   		then cs_sales_price* cs_quantity else 0 end) as jun_sales  	,sum(case when d_moy = 7   		then cs_sales_price* cs_quantity else 0 end) as jul_sales  	,sum(case when d_moy = 8   		then cs_sales_price* cs_quantity else 0 end) as aug_sales  	,sum(case when d_moy = 9   		then cs_sales_price* cs_quantity else 0 end) as sep_sales  	,sum(case when d_moy = 10   		then cs_sales_price* cs_quantity else 0 end) as oct_sales  	,sum(case when d_moy = 11  		then cs_sales_price* cs_quantity else 0 end) as nov_sales  	,sum(case when d_moy = 12  		then cs_sales_price* cs_quantity else 0 end) as dec_sales  	,sum(case when d_moy = 1   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net  	,sum(case when d_moy = 2   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net  	,sum(case when d_moy = 3   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net  	,sum(case when d_moy = 4   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net  	,sum(case when d_moy = 5   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net  	,sum(case when d_moy = 6   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net  	,sum(case when d_moy = 7   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net  	,sum(case when d_moy = 8   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net  	,sum(case when d_moy = 9   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net  	,sum(case when d_moy = 10   		then cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net  	,sum(case when d_moy = 11  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net  	,sum(case when d_moy = 12  		then cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net      from           catalog_sales          ,warehouse          ,date_dim          ,time_dim  	 ,ship_mode      where             cs_warehouse_sk =  w_warehouse_sk         and cs_sold_date_sk = d_date_sk         and cs_sold_time_sk = t_time_sk  	and cs_ship_mode_sk = sm_ship_mode_sk         and d_year = 2000  	and t_time between 33400 AND 33400+28800   	and sm_carrier in ('GERMA','AIRBORNE')      group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country        ,d_year  ) x  group by          w_warehouse_name  	,w_warehouse_sq_ft  	,w_city  	,w_county  	,w_state  	,w_country  	,ship_carriers        ,year  order by w_warehouse_name  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 3 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Riverside','Five Points')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 6 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Five Points','Oak Grove')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 2 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Pleasant Hill','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 8 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Fairview','Five Points')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 4 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Five Points','Pleasant Hill')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 7 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Midway','Pleasant Hill')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 3 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Fairview','Five Points')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 9 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Riverside','Pleasant Hill')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 2 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Oak Grove','Five Points')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 8 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Midway','Fairview')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('MT','VA','MI') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 2 and 2+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 2 and 2+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 2 and 2+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('OR','KY','IL') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('TN','WI','CA') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 2 and 2+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 2 and 2+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 2 and 2+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('IL','FL','MI') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2003 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2003 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('NY','KS','NC') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 2 and 2+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 2 and 2+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 2 and 2+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('MO','TX','WA') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('MI','IL','TX') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2002 and                 d_moy between 2 and 2+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 2 and 2+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2002 and                   d_moy between 2 and 2+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('OH','PA','KS') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('PA','SC','VA') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 2 and 2+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 2 and 2+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 2 and 2+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select     cd_gender,   cd_marital_status,   cd_education_status,   count(*) cnt1,   cd_purchase_estimate,   count(*) cnt2,   cd_credit_rating,   count(*) cnt3  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   ca_state in ('OK','OR','KS') and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_moy between 4 and 4+2) and    (not exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+2) and     not exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_moy between 4 and 4+2))  group by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  order by cd_gender,           cd_marital_status,           cd_education_status,           cd_purchase_estimate,           cd_credit_rating  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Ziebach County','Walker County','Williamson County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_promo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_addr_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_mode_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_mode_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_customer_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_bill_hdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_bill_hdemo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_bill_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_bill_customer_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_cdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_cdemo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_web_site_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_web_site_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_addr_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_hdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_hdemo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_customer_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_customer_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_bill_addr_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_addr_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_warehouse_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_warehouse_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_warehouse_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_warehouse_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_addr_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_addr_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_hdemo_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_hdemo_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_bill_hdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_bill_hdemo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_store_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_store_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_bill_customer_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_bill_customer_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_mode_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_mode_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_promo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_promo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_web_page_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_web_page_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_ship_customer_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_ship_customer_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_customer_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_bill_addr_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_bill_addr_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_promo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_promo_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (         SELECT 'store' as channel, 'ss_cdemo_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price          FROM store_sales, item, date_dim          WHERE ss_cdemo_sk IS NULL            AND ss_sold_date_sk=d_date_sk            AND ss_item_sk=i_item_sk         UNION ALL         SELECT 'web' as channel, 'ws_ship_mode_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price          FROM web_sales, item, date_dim          WHERE ws_ship_mode_sk IS NULL            AND ws_sold_date_sk=d_date_sk            AND ws_item_sk=i_item_sk         UNION ALL         SELECT 'catalog' as channel, 'cs_bill_addr_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price          FROM catalog_sales, item, date_dim          WHERE cs_bill_addr_sk IS NULL            AND cs_sold_date_sk=d_date_sk            AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 8 or household_demographics.hd_vehicle_count > 3)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 4 or household_demographics.hd_vehicle_count > 4)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > -1)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 1 or household_demographics.hd_vehicle_count > 2)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 2 or household_demographics.hd_vehicle_count > 0)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count > 4)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 4 or household_demographics.hd_vehicle_count > 2)     and date_dim.d_dow = 1     and date_dim.d_year in (2000,2000+1,2000+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 5 or household_demographics.hd_vehicle_count > 0)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 6 or household_demographics.hd_vehicle_count > 4)     and date_dim.d_dow = 1     and date_dim.d_year in (1998,1998+1,1998+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
select    c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit   from    (select ss_ticket_number           ,ss_customer_sk           ,store.s_city           ,sum(ss_coupon_amt) amt           ,sum(ss_net_profit) profit     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (household_demographics.hd_dep_count = 8 or household_demographics.hd_vehicle_count > -1)     and date_dim.d_dow = 1     and date_dim.d_year in (1999,1999+1,1999+2)      and store.s_number_employees between 200 and 295     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer     where ss_customer_sk = c_customer_sk  order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2002    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'MO'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2001    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'IA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2000    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'OK'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2002    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'OR'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2001    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'ID'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2002    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'IA'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2002    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'UT'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1998    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'AL'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =1999    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'WV'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
with customer_total_return as  (select cr_returning_customer_sk as ctr_customer_sk         ,ca_state as ctr_state,   	sum(cr_return_amt_inc_tax) as ctr_total_return  from catalog_returns      ,date_dim      ,customer_address  where cr_returned_date_sk = d_date_sk     and d_year =2001    and cr_returning_addr_sk = ca_address_sk   group by cr_returning_customer_sk          ,ca_state )   select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  from customer_total_return ctr1      ,customer_address      ,customer  where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2  			  from customer_total_return ctr2                    	  where ctr1.ctr_state = ctr2.ctr_state)        and ca_address_sk = c_current_addr_sk        and ca_state = 'OH'        and ctr1.ctr_customer_sk = c_customer_sk  order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name                    ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset                   ,ca_location_type,ctr_total_return  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 17 and 17+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-04-06' as date) and (cast('1998-04-06' as date) + interval 60 days)  and i_manufact_id in (316,711,408,301)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 33 and 33+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-02-20' as date) and (cast('1999-02-20' as date) + interval 60 days)  and i_manufact_id in (972,238,702,700)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 13 and 13+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-01-07' as date) and (cast('1998-01-07' as date) + interval 60 days)  and i_manufact_id in (930,487,128,25)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 29 and 29+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-05-25' as date) and (cast('2002-05-25' as date) + interval 60 days)  and i_manufact_id in (20,736,554,317)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 45 and 45+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-04-11' as date) and (cast('2001-04-11' as date) + interval 60 days)  and i_manufact_id in (544,985,980,859)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 61 and 61+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-04-11' as date) and (cast('2000-04-11' as date) + interval 60 days)  and i_manufact_id in (351,110,53,859)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 77 and 77+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-07-13' as date) and (cast('1999-07-13' as date) + interval 60 days)  and i_manufact_id in (158,836,946,637)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 2 and 2+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-05-30' as date) and (cast('1998-05-30' as date) + interval 60 days)  and i_manufact_id in (965,166,497,21)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 18 and 18+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-03-27' as date) and (cast('2002-03-27' as date) + interval 60 days)  and i_manufact_id in (416,390,331,32)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 34 and 34+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-02-09' as date) and (cast('2001-02-09' as date) + interval 60 days)  and i_manufact_id in (579,418,784,40)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2002-02-14','2002-08-28','2002-11-23')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2002-02-14','2002-08-28','2002-11-23')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('2002-02-14','2002-08-28','2002-11-23')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1999-06-17','1999-09-10','1999-11-05')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1999-06-17','1999-09-10','1999-11-05')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('1999-06-17','1999-09-10','1999-11-05')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2001-03-09','2001-09-28','2001-11-08')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2001-03-09','2001-09-28','2001-11-08')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('2001-03-09','2001-09-28','2001-11-08')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1998-07-09','1998-10-18','1998-11-12')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1998-07-09','1998-10-18','1998-11-12')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('1998-07-09','1998-10-18','1998-11-12')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2000-02-19','2000-09-22','2000-11-16')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2000-02-19','2000-09-22','2000-11-16')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('2000-02-19','2000-09-22','2000-11-16')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2002-01-10','2002-08-27','2002-11-02')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2002-01-10','2002-08-27','2002-11-02')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('2002-01-10','2002-08-27','2002-11-02')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1999-04-23','1999-09-15','1999-11-06')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1999-04-23','1999-09-15','1999-11-06')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('1999-04-23','1999-09-15','1999-11-06')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2001-01-13','2001-10-04','2001-11-09')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2001-01-13','2001-10-04','2001-11-09')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('2001-01-13','2001-10-04','2001-11-09')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1998-05-16','1998-10-23','1998-11-13')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('1998-05-16','1998-10-23','1998-11-13')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('1998-05-16','1998-10-23','1998-11-13')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
with sr_items as  (select i_item_id item_id,         sum(sr_return_quantity) sr_item_qty  from store_returns,       item,       date_dim  where sr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2000-01-05','2000-09-10','2000-11-17')))  and   sr_returned_date_sk   = d_date_sk  group by i_item_id),  cr_items as  (select i_item_id item_id,         sum(cr_return_quantity) cr_item_qty  from catalog_returns,       item,       date_dim  where cr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 	  where d_date in ('2000-01-05','2000-09-10','2000-11-17')))  and   cr_returned_date_sk   = d_date_sk  group by i_item_id),  wr_items as  (select i_item_id item_id,         sum(wr_return_quantity) wr_item_qty  from web_returns,       item,       date_dim  where wr_item_sk = i_item_sk  and   d_date    in  	(select d_date 	from date_dim 	where d_week_seq in  		(select d_week_seq 		from date_dim 		where d_date in ('2000-01-05','2000-09-10','2000-11-17')))  and   wr_returned_date_sk   = d_date_sk  group by i_item_id)   select  sr_items.item_id        ,sr_item_qty        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev        ,cr_item_qty        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev        ,wr_item_qty        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average  from sr_items      ,cr_items      ,wr_items  where sr_items.item_id=cr_items.item_id    and sr_items.item_id=wr_items.item_id   order by sr_items.item_id          ,sr_item_qty  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Waterloo'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  34290    and ib_upper_bound   <=  34290 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Buena Vista'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  51097    and ib_upper_bound   <=  51097 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Ashland'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  67904    and ib_upper_bound   <=  67904 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Harmony'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  14710    and ib_upper_bound   <=  14710 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Enterprise'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  31517    and ib_upper_bound   <=  31517 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Ashland'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  48324    and ib_upper_bound   <=  48324 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Harmony'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  65131    and ib_upper_bound   <=  65131 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Enterprise'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  11937    and ib_upper_bound   <=  11937 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Springfield'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  28744    and ib_upper_bound   <=  28744 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  c_customer_id as customer_id        , concat(c_last_name, ',' , c_first_name) as customername  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Lebanon'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  45551    and ib_upper_bound   <=  45551 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk  order by c_customer_id  limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2002    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('OK', 'KY', 'IN')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('WI', 'CO', 'MI')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('SC', 'MO', 'ID')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1999    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('KY', 'VA', 'WV')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('MN', 'CO', 'KS')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NE', 'SC', 'MS')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2001    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Unknown'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('VA', 'OH', 'GA')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('AR', 'RI', 'WA')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('PA', 'OR', 'OK')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1998    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('TX', 'AL', 'AR')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('NY', 'FL', 'WI')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('LA', 'KS', 'MO')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('WV', 'SC', 'MO')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('OH', 'UT', 'OK')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('PA', 'CO', 'MI')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2002    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('AR', 'IL', 'IA')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('CO', 'KY', 'CA')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('MN', 'MS', 'PA')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1999    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Primary'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('AL', 'KS', 'NH')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('MI', 'OH', 'GA')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('ID', 'CA', 'IL')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2001    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'S'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('KY', 'KS', 'MO')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('WV', 'MI', 'MS')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('CA', 'SC', 'TN')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 1998    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Advanced Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '2 yr Degree'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'U'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('NY', 'NC', 'HI')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('CO', 'VA', 'GA')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NE', 'AL', 'TX')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  substr(r_reason_desc,1,20)        ,avg(ws_quantity)        ,avg(wr_refunded_cash)        ,avg(wr_fee)  from web_sales, web_returns, web_page, customer_demographics cd1,       customer_demographics cd2, customer_address, date_dim, reason   where ws_web_page_sk = wp_web_page_sk    and ws_item_sk = wr_item_sk    and ws_order_number = wr_order_number    and ws_sold_date_sk = d_date_sk and d_year = 2000    and cd1.cd_demo_sk = wr_refunded_cdemo_sk     and cd2.cd_demo_sk = wr_returning_cdemo_sk    and ca_address_sk = wr_refunded_addr_sk    and r_reason_sk = wr_reason_sk    and    (     (      cd1.cd_marital_status = 'D'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = '4 yr Degree'      and       cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 100.00 and 150.00     )    or     (      cd1.cd_marital_status = 'W'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'College'       and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 50.00 and 100.00     )    or     (      cd1.cd_marital_status = 'M'      and      cd1.cd_marital_status = cd2.cd_marital_status      and      cd1.cd_education_status = 'Secondary'      and      cd1.cd_education_status = cd2.cd_education_status      and      ws_sales_price between 150.00 and 200.00     )    )    and    (     (      ca_country = 'United States'      and      ca_state in ('ME', 'MD', 'LA')      and ws_net_profit between 100 and 200       )     or     (      ca_country = 'United States'      and      ca_state in ('GA', 'WV', 'KY')      and ws_net_profit between 150 and 300       )     or     (      ca_country = 'United States'      and      ca_state in ('NE', 'PA', 'VA')      and ws_net_profit between 50 and 250       )    ) group by r_reason_desc order by substr(r_reason_desc,1,20)         ,avg(ws_quantity)         ,avg(wr_refunded_cash)         ,avg(wr_fee) limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2001) and         ((i_category in ('Sports','Books','Music') and           i_class in ('athletic shoes','romance','classical')          )       or (i_category in ('Women','Children','Jewelry') and           i_class in ('dresses','toddlers','mens watch')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2001) and         ((i_category in ('Shoes','Books','Music') and           i_class in ('athletic','cooking','country')          )       or (i_category in ('Home','Men','Women') and           i_class in ('flatware','accessories','swimwear')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Electronics','Home','Shoes') and           i_class in ('wireless','glassware','athletic')          )       or (i_category in ('Music','Jewelry','Children') and           i_class in ('pop','custom','school-uniforms')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Home','Jewelry','Music') and           i_class in ('decor','birdal','country')          )       or (i_category in ('Books','Men','Sports') and           i_class in ('entertainments','sports-apparel','athletic shoes')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Shoes','Women','Children') and           i_class in ('kids','swimwear','school-uniforms')          )       or (i_category in ('Electronics','Jewelry','Music') and           i_class in ('cameras','jewelry boxes','rock')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Women','Jewelry','Books') and           i_class in ('fragrances','pendants','travel')          )       or (i_category in ('Men','Shoes','Music') and           i_class in ('accessories','kids','country')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Sports','Children','Women') and           i_class in ('tennis','infants','swimwear')          )       or (i_category in ('Electronics','Music','Home') and           i_class in ('memory','rock','flatware')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Music','Home','Children') and           i_class in ('rock','wallpaper','infants')          )       or (i_category in ('Women','Electronics','Books') and           i_class in ('maternity','memory','business')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2002) and         ((i_category in ('Music','Shoes','Electronics') and           i_class in ('rock','athletic','wireless')          )       or (i_category in ('Men','Jewelry','Sports') and           i_class in ('sports-apparel','consignment','archery')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2002) and         ((i_category in ('Books','Children','Shoes') and           i_class in ('entertainments','toddlers','mens')          )       or (i_category in ('Jewelry','Home','Men') and           i_class in ('birdal','blinds/shades','pants')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 7 and 7+1          and household_demographics.hd_dep_count = 7          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 16 and 16+1          and household_demographics.hd_dep_count = 7          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 7 and 7+1          and household_demographics.hd_dep_count = 0          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 20 and 20+1          and household_demographics.hd_dep_count = 0          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 7 and 7+1          and household_demographics.hd_dep_count = 6          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 15 and 15+1          and household_demographics.hd_dep_count = 6          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 7 and 7+1          and household_demographics.hd_dep_count = 2          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 19 and 19+1          and household_demographics.hd_dep_count = 2          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 7 and 7+1          and household_demographics.hd_dep_count = 8          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 14 and 14+1          and household_demographics.hd_dep_count = 8          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 6 and 6+1          and household_demographics.hd_dep_count = 1          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 18 and 18+1          and household_demographics.hd_dep_count = 1          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 6 and 6+1          and household_demographics.hd_dep_count = 7          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 13 and 13+1          and household_demographics.hd_dep_count = 7          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 6 and 6+1          and household_demographics.hd_dep_count = 2          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 16 and 16+1          and household_demographics.hd_dep_count = 2          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 6 and 6+1          and household_demographics.hd_dep_count = 8          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 20 and 20+1          and household_demographics.hd_dep_count = 8          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio  from ( select count(*) amc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 12 and 12+1          and household_demographics.hd_dep_count = 3          and web_page.wp_char_count between 5000 and 5200) at,       ( select count(*) pmc        from web_sales, household_demographics , time_dim, web_page        where ws_sold_time_sk = time_dim.t_time_sk          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk          and ws_web_page_sk = web_page.wp_web_page_sk          and time_dim.t_hour between 14 and 14+1          and household_demographics.hd_dep_count = 3          and web_page.wp_char_count between 5000 and 5200) pt  order by am_pm_ratio  limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 628 and i_item_sk = ws_item_sk  and d_date between '2002-03-31' and          (cast('2002-03-31' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2002-03-31' and                              (cast('2002-03-31' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 701 and i_item_sk = ws_item_sk  and d_date between '1999-03-13' and          (cast('1999-03-13' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1999-03-13' and                              (cast('1999-03-13' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 127 and i_item_sk = ws_item_sk  and d_date between '2001-02-21' and          (cast('2001-02-21' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2001-02-21' and                              (cast('2001-02-21' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 553 and i_item_sk = ws_item_sk  and d_date between '1998-02-03' and          (cast('1998-02-03' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1998-02-03' and                              (cast('1998-02-03' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 979 and i_item_sk = ws_item_sk  and d_date between '2000-01-16' and          (cast('2000-01-16' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2000-01-16' and                              (cast('2000-01-16' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 52 and i_item_sk = ws_item_sk  and d_date between '2002-02-15' and          (cast('2002-02-15' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2002-02-15' and                              (cast('2002-02-15' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 478 and i_item_sk = ws_item_sk  and d_date between '1999-01-28' and          (cast('1999-01-28' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1999-01-28' and                              (cast('1999-01-28' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 904 and i_item_sk = ws_item_sk  and d_date between '2001-01-09' and          (cast('2001-01-09' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2001-01-09' and                              (cast('2001-01-09' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 330 and i_item_sk = ws_item_sk  and d_date between '1998-03-21' and          (cast('1998-03-21' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '1998-03-21' and                              (cast('1998-03-21' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      sum(ws_ext_discount_amt)  as Excess_Discount_Amount  from      web_sales     ,item     ,date_dim where i_manufact_id = 403 and i_item_sk = ws_item_sk  and d_date between '2000-03-15' and          (cast('2000-03-15' as date) + interval 90 days) and d_date_sk = ws_sold_date_sk  and ws_ext_discount_amt        > (           SELECT              1.3 * avg(ws_ext_discount_amt)           FROM              web_sales             ,date_dim          WHERE                ws_item_sk = i_item_sk            and d_date between '2000-03-15' and                              (cast('2000-03-15' as date) + interval 90 days)           and d_date_sk = ws_sold_date_sk        )  order by sum(ws_ext_discount_amt) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2001-5-01' and             (cast('2001-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'PA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KY' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2001-4-01' and             (cast('2001-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MN' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-5-01' and             (cast('2002-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MT' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KS' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-3-01' and             (cast('2002-3-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'IL' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-4-01' and             (cast('2000-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'AR' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'OK' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-5-01' and             (cast('1999-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'CA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'SD' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2001-5-01' and             (cast('2001-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'PA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KY' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2001-4-01' and             (cast('2001-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MN' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-5-01' and             (cast('2002-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MT' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KS' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-3-01' and             (cast('2002-3-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'IL' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-4-01' and             (cast('2000-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'AR' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'OK' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-5-01' and             (cast('1999-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'CA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'SD' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Home', 'Sports', 'Shoes')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2000-02-16' as date)  				and (cast('2000-02-16' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Children', 'Sports', 'Shoes')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2000-05-09' as date)  				and (cast('2000-05-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Books', 'Jewelry', 'Children')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2000-02-01' as date)  				and (cast('2000-02-01' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Jewelry', 'Music', 'Shoes')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1998-04-29' as date)  				and (cast('1998-04-29' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Children', 'Electronics', 'Men')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1998-02-17' as date)  				and (cast('1998-02-17' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Electronics', 'Music', 'Sports')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2001-04-03' as date)  				and (cast('2001-04-03' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Home', 'Men', 'Electronics')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2001-01-23' as date)  				and (cast('2001-01-23' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Shoes', 'Jewelry', 'Men')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2001-03-09' as date)  				and (cast('2001-03-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Shoes', 'Children', 'Books')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1999-06-27' as date)  				and (cast('1999-06-27' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Sports', 'Men', 'Children')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1999-02-11' as date)  				and (cast('1999-02-11' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
