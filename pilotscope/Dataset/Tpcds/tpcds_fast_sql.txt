select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 44 and 44 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1998-01-03' as date) and (cast('1998-01-03' as date) + interval 60 days)  and i_manufact_id in (705,684,863,843)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 47 and 47 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-01-08' as date) and (cast('2001-01-08' as date) + interval 60 days)  and i_manufact_id in (891,688,690,698)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 18 and 18 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-01-10' as date) and (cast('2001-01-10' as date) + interval 60 days)  and i_manufact_id in (897,939,949,742)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 21 and 21 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-02-03' as date) and (cast('1999-02-03' as date) + interval 60 days)  and i_manufact_id in (917,755,879,816)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 24 and 24 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2002-02-28' as date) and (cast('2002-02-28' as date) + interval 60 days)  and i_manufact_id in (769,948,998,789)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 53 and 53 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('1999-02-06' as date) and (cast('1999-02-06' as date) + interval 60 days)  and i_manufact_id in (676,861,855,762)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, store_sales  where i_current_price between 45 and 45+30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-04-11' as date) and (cast('2001-04-11' as date) + interval 60 days)  and i_manufact_id in (544,985,980,859)  and inv_quantity_on_hand between 100 and 500  and ss_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Ziebach County','Walker County','Williamson County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 854 and 854+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'azure' or i_color = 'goldenrod') and          (i_units = 'Tsp' or i_units = 'Each') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'ivory' or i_color = 'olive') and         (i_units = 'Pallet' or i_units = 'Gram') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'powder' or i_color = 'linen') and         (i_units = 'Box' or i_units = 'Carton') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'peru' or i_color = 'salmon') and         (i_units = 'Tbl' or i_units = 'Pound') and         (i_size = 'extra large' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'metallic' or i_color = 'navajo') and          (i_units = 'Bunch' or i_units = 'Dram') and         (i_size = 'extra large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'lime' or i_color = 'tomato') and         (i_units = 'Bundle' or i_units = 'Lb') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'chartreuse' or i_color = 'floral') and         (i_units = 'N/A' or i_units = 'Cup') and         (i_size = 'large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'dim' or i_color = 'blush') and         (i_units = 'Ounce' or i_units = 'Unknown') and         (i_size = 'extra large' or i_size = 'small')         )))) > 0  order by i_product_name  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 9 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (1999,1999+1,1999+2)         and store.s_city in ('Riverside','Pleasant Hill')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 2 or              household_demographics.hd_vehicle_count= 0)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Oak Grove','Five Points')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 4 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Five Points','Pleasant Hill')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select  i_item_id,         s_state, grouping(s_state) g_state,         avg(ss_quantity) agg1,         avg(ss_list_price) agg2,         avg(ss_coupon_amt) agg3,         avg(ss_sales_price) agg4  from store_sales, customer_demographics, date_dim, store, item  where ss_sold_date_sk = d_date_sk and        ss_item_sk = i_item_sk and        ss_store_sk = s_store_sk and        ss_cdemo_sk = cd_demo_sk and        cd_gender = 'F' and        cd_marital_status = 'M' and        cd_education_status = '2 yr Degree' and        d_year = 2001 and        s_state in ('TN','SD', 'AL', 'TN', 'SD', 'SD')  group by rollup (i_item_id, s_state)  order by i_item_id          ,s_state  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 867 and 867+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'yellow' or i_color = 'ghost') and          (i_units = 'Box' or i_units = 'Bunch') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'cream' or i_color = 'burlywood') and         (i_units = 'Lb' or i_units = 'Unknown') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'drab' or i_color = 'steel') and         (i_units = 'Oz' or i_units = 'Gross') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'magenta' or i_color = 'coral') and         (i_units = 'Pallet' or i_units = 'Pound') and         (i_size = 'N/A' or i_size = 'economy')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'papaya' or i_color = 'lime') and          (i_units = 'Dram' or i_units = 'Each') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'rosy' or i_color = 'grey') and         (i_units = 'Case' or i_units = 'Gram') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'white' or i_color = 'frosted') and         (i_units = 'Ton' or i_units = 'Tbl') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'antique' or i_color = 'metallic') and         (i_units = 'Ounce' or i_units = 'Tsp') and         (i_size = 'N/A' or i_size = 'economy')         )))) > 0  order by i_product_name  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Walker County','Ziebach County','Williamson County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 6 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (2000,2000+1,2000+2)         and store.s_city in ('Five Points','Oak Grove')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Shoes', 'Children', 'Books')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1999-06-27' as date)  				and (cast('1999-06-27' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Home', 'Men', 'Electronics')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2001-01-23' as date)  				and (cast('2001-01-23' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Sports', 'Men', 'Children')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1999-02-11' as date)  				and (cast('1999-02-11' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Children', 'Electronics', 'Men')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1998-02-17' as date)  				and (cast('1998-02-17' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Shoes', 'Jewelry', 'Men')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2001-03-09' as date)  				and (cast('2001-03-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '>10000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Walker County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Children', 'Books')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-06-27' as date)   				and (cast('1999-06-27' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 987 and 987+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'goldenrod' or i_color = 'powder') and          (i_units = 'Tsp' or i_units = 'Box') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'blue' or i_color = 'puff') and         (i_units = 'Bunch' or i_units = 'Gram') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'tan' or i_color = 'ghost') and         (i_units = 'Bundle' or i_units = 'Pallet') and         (i_size = 'extra large' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'pale' or i_color = 'olive') and         (i_units = 'Case' or i_units = 'Ton') and         (i_size = 'large' or i_size = 'N/A')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'lace' or i_color = 'steel') and          (i_units = 'Dozen' or i_units = 'Cup') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'firebrick' or i_color = 'maroon') and         (i_units = 'Ounce' or i_units = 'Pound') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'smoke' or i_color = 'linen') and         (i_units = 'Unknown' or i_units = 'Tbl') and         (i_size = 'extra large' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'chocolate' or i_color = 'mint') and         (i_units = 'Each' or i_units = 'N/A') and         (i_size = 'large' or i_size = 'N/A')         )))) > 0  order by i_product_name  limit 100;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Jewelry', 'Music', 'Shoes')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('1998-04-29' as date)  				and (cast('1998-04-29' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Shoes', 'Jewelry', 'Men')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2001-03-09' as date)   				and (cast('2001-03-09' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Children', 'Electronics', 'Men')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-02-17' as date)   				and (cast('1998-02-17' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Children', 'Sports', 'Shoes')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2000-05-09' as date)  				and (cast('2000-05-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 41 and 41 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2000-03-23' as date) and (cast('2000-03-23' as date) + interval 60 days)  and i_manufact_id in (778,777,716,870)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Books', 'Jewelry', 'Children')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-02-01' as date)   				and (cast('2000-02-01' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 1000 and 1000+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'deep' or i_color = 'lavender') and          (i_units = 'Bundle' or i_units = 'Box') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'forest' or i_color = 'almond') and         (i_units = 'Ton' or i_units = 'Cup') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'red' or i_color = 'drab') and         (i_units = 'Bunch' or i_units = 'Dozen') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'royal' or i_color = 'burnished') and         (i_units = 'Tbl' or i_units = 'Gross') and         (i_size = 'small' or i_size = 'petite')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'hot' or i_color = 'grey') and          (i_units = 'Unknown' or i_units = 'Ounce') and         (i_size = 'small' or i_size = 'petite')         ) or         (i_category = 'Women' and         (i_color = 'light' or i_color = 'cyan') and         (i_units = 'Case' or i_units = 'Oz') and         (i_size = 'extra large' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'aquamarine' or i_color = 'beige') and         (i_units = 'Pallet' or i_units = 'Dram') and         (i_size = 'large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'midnight' or i_color = 'orange') and         (i_units = 'Gram' or i_units = 'Carton') and         (i_size = 'small' or i_size = 'petite')         )))) > 0  order by i_product_name  limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Jewelry', 'Music', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1998-04-29' as date)   				and (cast('1998-04-29' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  c_last_name        ,c_first_name        ,ca_city        ,bought_city        ,ss_ticket_number        ,extended_price        ,extended_tax        ,list_price  from (select ss_ticket_number              ,ss_customer_sk              ,ca_city bought_city              ,sum(ss_ext_sales_price) extended_price               ,sum(ss_ext_list_price) list_price              ,sum(ss_ext_tax) extended_tax         from store_sales            ,date_dim            ,store            ,household_demographics            ,customer_address         where store_sales.ss_sold_date_sk = date_dim.d_date_sk          and store_sales.ss_store_sk = store.s_store_sk           and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk         and store_sales.ss_addr_sk = customer_address.ca_address_sk         and date_dim.d_dom between 1 and 2          and (household_demographics.hd_dep_count = 3 or              household_demographics.hd_vehicle_count= 1)         and date_dim.d_year in (1998,1998+1,1998+2)         and store.s_city in ('Riverside','Five Points')        group by ss_ticket_number                ,ss_customer_sk                ,ss_addr_sk,ca_city) dn       ,customer       ,customer_address current_addr  where ss_customer_sk = c_customer_sk    and customer.c_current_addr_sk = current_addr.ca_address_sk    and current_addr.ca_city <> bought_city  order by c_last_name          ,ss_ticket_number  limit 100;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Books', 'Jewelry', 'Children')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2000-02-01' as date)  				and (cast('2000-02-01' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Shoes', 'Children', 'Books')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1999-06-27' as date)  				and (cast('1999-06-27' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Home', 'Men', 'Electronics')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2001-01-23' as date)   				and (cast('2001-01-23' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Home', 'Men', 'Electronics')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2001-01-23' as date)  				and (cast('2001-01-23' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Shoes', 'Jewelry', 'Men')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2001-03-09' as date)  				and (cast('2001-03-09' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Children', 'Sports', 'Shoes')    and cs_sold_date_sk = d_date_sk  and d_date between cast('2000-05-09' as date)   				and (cast('2000-05-09' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2001-4-01' and             (cast('2001-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MN' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 760 and 760+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'bisque' or i_color = 'pale') and          (i_units = 'Box' or i_units = 'Unknown') and         (i_size = 'medium' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'floral' or i_color = 'blue') and         (i_units = 'Ounce' or i_units = 'Dram') and         (i_size = 'economy' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'lawn' or i_color = 'dark') and         (i_units = 'Cup' or i_units = 'N/A') and         (i_size = 'extra large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'lace' or i_color = 'coral') and         (i_units = 'Gross' or i_units = 'Case') and         (i_size = 'medium' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'dodger' or i_color = 'orchid') and          (i_units = 'Bundle' or i_units = 'Pound') and         (i_size = 'medium' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'beige' or i_color = 'cornsilk') and         (i_units = 'Ton' or i_units = 'Dozen') and         (i_size = 'economy' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'thistle' or i_color = 'ivory') and         (i_units = 'Gram' or i_units = 'Carton') and         (i_size = 'extra large' or i_size = 'N/A')         ) or         (i_category = 'Men' and         (i_color = 'blanched' or i_color = 'cream') and         (i_units = 'Oz' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'small')         )))) > 0  order by i_product_name  limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 747 and 747+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'spring' or i_color = 'saddle') and          (i_units = 'Carton' or i_units = 'Lb') and         (i_size = 'large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'deep' or i_color = 'drab') and         (i_units = 'Bundle' or i_units = 'Ton') and         (i_size = 'extra large' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'steel' or i_color = 'lace') and         (i_units = 'Dram' or i_units = 'Ounce') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'rose' or i_color = 'orchid') and         (i_units = 'Case' or i_units = 'Each') and         (i_size = 'large' or i_size = 'small')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'gainsboro' or i_color = 'slate') and          (i_units = 'Dozen' or i_units = 'N/A') and         (i_size = 'large' or i_size = 'small')         ) or         (i_category = 'Women' and         (i_color = 'navy' or i_color = 'papaya') and         (i_units = 'Tsp' or i_units = 'Pallet') and         (i_size = 'extra large' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'lime' or i_color = 'lavender') and         (i_units = 'Tbl' or i_units = 'Oz') and         (i_size = 'N/A' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'orange' or i_color = 'green') and         (i_units = 'Unknown' or i_units = 'Box') and         (i_size = 'large' or i_size = 'small')         )))) > 0  order by i_product_name  limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KY' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Electronics', 'Music', 'Sports')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2001-04-03' as date)  				and (cast('2001-04-03' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id        ,i_item_desc         ,i_category         ,i_class         ,i_current_price        ,sum(cs_ext_sales_price) as itemrevenue         ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over            (partition by i_class) as revenueratio  from	catalog_sales      ,item       ,date_dim  where cs_item_sk = i_item_sk     and i_category in ('Sports', 'Men', 'Children')    and cs_sold_date_sk = d_date_sk  and d_date between cast('1999-02-11' as date)   				and (cast('1999-02-11' as date) + interval 30 days)  group by i_item_id          ,i_item_desc           ,i_category          ,i_class          ,i_current_price  order by i_category          ,i_class          ,i_item_id          ,i_item_desc          ,revenueratio limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-3-01' and             (cast('2002-3-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'IL' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'SD' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 974 and 974+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'cornflower' or i_color = 'magenta') and          (i_units = 'Unknown' or i_units = 'Bunch') and         (i_size = 'petite' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'azure' or i_color = 'burnished') and         (i_units = 'Ounce' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'medium' or i_color = 'spring') and         (i_units = 'Case' or i_units = 'Box') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'powder' or i_color = 'mint') and         (i_units = 'Lb' or i_units = 'Gram') and         (i_size = 'petite' or i_size = 'N/A')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'cyan' or i_color = 'rose') and          (i_units = 'Ton' or i_units = 'Carton') and         (i_size = 'petite' or i_size = 'N/A')         ) or         (i_category = 'Women' and         (i_color = 'antique' or i_color = 'saddle') and         (i_units = 'Cup' or i_units = 'N/A') and         (i_size = 'small' or i_size = 'economy')         ) or         (i_category = 'Men' and         (i_color = 'royal' or i_color = 'almond') and         (i_units = 'Tbl' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'sky' or i_color = 'drab') and         (i_units = 'Bundle' or i_units = 'Dram') and         (i_size = 'petite' or i_size = 'N/A')         )))) > 0  order by i_product_name  limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KS' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-4-01' and             (cast('2000-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'AR' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-5-01' and             (cast('1999-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'CA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-5-01' and             (cast('2002-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MT' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Children', 'Electronics', 'Men')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1998-02-17' as date)  				and (cast('1998-02-17' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = '0-500')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1999,1999+1,1999+2)     and store.s_county in ('Williamson County','Ziebach County','Walker County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Books', 'Jewelry', 'Children')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('2000-02-01' as date)  				and (cast('2000-02-01' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Sports', 'Men', 'Children')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1999-02-11' as date)  				and (cast('1999-02-11' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 880 and 880+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'forest' or i_color = 'snow') and          (i_units = 'Case' or i_units = 'Box') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Women' and         (i_color = 'cyan' or i_color = 'peach') and         (i_units = 'Lb' or i_units = 'Bundle') and         (i_size = 'economy' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'cornflower' or i_color = 'burnished') and         (i_units = 'Dram' or i_units = 'Pallet') and         (i_size = 'N/A' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'bisque' or i_color = 'olive') and         (i_units = 'Tbl' or i_units = 'Bunch') and         (i_size = 'small' or i_size = 'large')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'tan' or i_color = 'magenta') and          (i_units = 'Carton' or i_units = 'Ounce') and         (i_size = 'small' or i_size = 'large')         ) or         (i_category = 'Women' and         (i_color = 'lemon' or i_color = 'pale') and         (i_units = 'Dozen' or i_units = 'Each') and         (i_size = 'economy' or i_size = 'petite')         ) or         (i_category = 'Men' and         (i_color = 'mint' or i_color = 'dim') and         (i_units = 'Gross' or i_units = 'N/A') and         (i_size = 'N/A' or i_size = 'medium')         ) or         (i_category = 'Men' and         (i_color = 'tomato' or i_color = 'lime') and         (i_units = 'Oz' or i_units = 'Pound') and         (i_size = 'small' or i_size = 'large')         )))) > 0  order by i_product_name  limit 100;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Ziebach County','Walker County','Williamson County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc;
select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag        ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)     and (household_demographics.hd_buy_potential = '1001-5000' or          household_demographics.hd_buy_potential = '5001-10000')     and household_demographics.hd_vehicle_count > 0     and (case when household_demographics.hd_vehicle_count > 0  	then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count  	else null  	end)  > 1.2     and date_dim.d_year in (1998,1998+1,1998+2)     and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County',                            'Ziebach County','Ziebach County','Ziebach County','Ziebach County')     group by ss_ticket_number,ss_customer_sk) dn,customer     where ss_customer_sk = c_customer_sk       and cnt between 15 and 20     order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;
select  distinct(i_product_name)  from item i1  where i_manufact_id between 773 and 773+40     and (select count(*) as item_cnt         from item         where (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'goldenrod' or i_color = 'orange') and          (i_units = 'Carton' or i_units = 'Box') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'honeydew' or i_color = 'sienna') and         (i_units = 'Ton' or i_units = 'Case') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'mint' or i_color = 'navy') and         (i_units = 'Gram' or i_units = 'Lb') and         (i_size = 'small' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'white' or i_color = 'antique') and         (i_units = 'Oz' or i_units = 'Gross') and         (i_size = 'petite' or i_size = 'economy')         ))) or        (i_manufact = i1.i_manufact and         ((i_category = 'Women' and          (i_color = 'metallic' or i_color = 'khaki') and          (i_units = 'Pound' or i_units = 'Cup') and         (i_size = 'petite' or i_size = 'economy')         ) or         (i_category = 'Women' and         (i_color = 'floral' or i_color = 'deep') and         (i_units = 'Bunch' or i_units = 'Pallet') and         (i_size = 'medium' or i_size = 'large')         ) or         (i_category = 'Men' and         (i_color = 'magenta' or i_color = 'firebrick') and         (i_units = 'Dram' or i_units = 'Tsp') and         (i_size = 'small' or i_size = 'extra large')         ) or         (i_category = 'Men' and         (i_color = 'chiffon' or i_color = 'ghost') and         (i_units = 'N/A' or i_units = 'Unknown') and         (i_size = 'petite' or i_size = 'economy')         )))) > 0  order by i_product_name  limit 100;
select  i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ws_ext_sales_price) as itemrevenue        ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	web_sales     	,item      	,date_dim where  	ws_item_sk = i_item_sk    	and i_category in ('Jewelry', 'Music', 'Shoes')   	and ws_sold_date_sk = d_date_sk 	and d_date between cast('1998-04-29' as date)  				and (cast('1998-04-29' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio limit 100;
select  i_item_id        ,i_item_desc        ,i_current_price  from item, inventory, date_dim, catalog_sales  where i_current_price between 50 and 50 + 30  and inv_item_sk = i_item_sk  and d_date_sk=inv_date_sk  and d_date between cast('2001-02-01' as date) and (cast('2001-02-01' as date) + interval 60 days)  and i_manufact_id in (824,937,972,793)  and inv_quantity_on_hand between 100 and 500  and cs_item_sk = i_item_sk  group by i_item_id,i_item_desc,i_current_price  order by i_item_id  limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Music','Home','Children') and           i_class in ('rock','wallpaper','infants')          )       or (i_category in ('Women','Electronics','Books') and           i_class in ('maternity','memory','business')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Women','Jewelry','Books') and           i_class in ('fragrances','pendants','travel')          )       or (i_category in ('Men','Shoes','Music') and           i_class in ('accessories','kids','country')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Electronics','Home','Shoes') and           i_class in ('wireless','glassware','athletic')          )       or (i_category in ('Music','Jewelry','Children') and           i_class in ('pop','custom','school-uniforms')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2000) and         ((i_category in ('Sports','Children','Women') and           i_class in ('tennis','infants','swimwear')          )       or (i_category in ('Electronics','Music','Home') and           i_class in ('memory','rock','flatware')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'F' and         cd1.cd_education_status = '2 yr Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (6,12,10,7,9,4) and        d_year = 1999 and        ca_state in ('ND','MO','UT'                    ,'DE','WV','GA','NE')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2001) and         ((i_category in ('Shoes','Books','Music') and           i_class in ('athletic','cooking','country')          )       or (i_category in ('Home','Men','Women') and           i_class in ('flatware','accessories','swimwear')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KS' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-3-01' and             (cast('2002-3-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'IL' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Home','Jewelry','Music') and           i_class in ('decor','birdal','country')          )       or (i_category in ('Books','Men','Sports') and           i_class in ('entertainments','sports-apparel','athletic shoes')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2002-5-01' and             (cast('2002-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'MT' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (1998) and         ((i_category in ('Shoes','Women','Children') and           i_class in ('kids','swimwear','school-uniforms')          )       or (i_category in ('Electronics','Jewelry','Music') and           i_class in ('cameras','jewelry boxes','rock')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-4-01' and             (cast('2000-4-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'AR' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'SD' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
select  * from( select i_category, i_class, i_brand,        s_store_name, s_company_name,        d_moy,        sum(ss_sales_price) sum_sales,        avg(sum(ss_sales_price)) over          (partition by i_category, i_brand, s_store_name, s_company_name)          avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and       ss_sold_date_sk = d_date_sk and       ss_store_sk = s_store_sk and       d_year in (2002) and         ((i_category in ('Music','Shoes','Electronics') and           i_class in ('rock','athletic','wireless')          )       or (i_category in ('Men','Jewelry','Sports') and           i_class in ('sports-apparel','consignment','archery')          )) group by i_category, i_class, i_brand,          s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'KY' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
select  i_item_id,         ca_country,         ca_state,          ca_county,         avg( cast(cs_quantity as decimal(12,2))) agg1,         avg( cast(cs_list_price as decimal(12,2))) agg2,         avg( cast(cs_coupon_amt as decimal(12,2))) agg3,         avg( cast(cs_sales_price as decimal(12,2))) agg4,         avg( cast(cs_net_profit as decimal(12,2))) agg5,         avg( cast(c_birth_year as decimal(12,2))) agg6,         avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7  from catalog_sales, customer_demographics cd1,        customer_demographics cd2, customer, customer_address, date_dim, item  where cs_sold_date_sk = d_date_sk and        cs_item_sk = i_item_sk and        cs_bill_cdemo_sk = cd1.cd_demo_sk and        cs_bill_customer_sk = c_customer_sk and        cd1.cd_gender = 'M' and         cd1.cd_education_status = '2 yr Degree' and        c_current_cdemo_sk = cd2.cd_demo_sk and        c_current_addr_sk = ca_address_sk and        c_birth_month in (5,9,6,1,7,10) and        d_year = 2001 and        ca_state in ('AR','MI','NC'                    ,'MN','ME','IA','OH')  group by rollup (i_item_id, ca_country, ca_state, ca_county)  order by ca_country,         ca_state,          ca_county, 	i_item_id  limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-2-01' and             (cast('1999-2-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'OK' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2  from web_sales ws1,web_sales ws2  where ws1.ws_order_number = ws2.ws_order_number    and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)  select      count(distinct ws_order_number) as order_count   ,sum(ws_ext_ship_cost) as total_shipping_cost   ,sum(ws_net_profit) as total_net_profit from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '1999-5-01' and             (cast('1999-5-01' as date) + interval 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'CA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number                             from ws_wh) and ws1.ws_order_number in (select wr_order_number                             from web_returns,ws_wh                             where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100;
select i_item_id       ,i_item_desc        ,i_category        ,i_class        ,i_current_price       ,sum(ss_ext_sales_price) as itemrevenue        ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over           (partition by i_class) as revenueratio from	 	store_sales     	,item      	,date_dim where  	ss_item_sk = i_item_sk    	and i_category in ('Electronics', 'Music', 'Sports')   	and ss_sold_date_sk = d_date_sk 	and d_date between cast('2001-04-03' as date)  				and (cast('2001-04-03' as date) + interval 30 days) group by  	i_item_id         ,i_item_desc          ,i_category         ,i_class         ,i_current_price order by  	i_category         ,i_class         ,i_item_id         ,i_item_desc         ,revenueratio;
